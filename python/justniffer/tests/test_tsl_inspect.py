import ssl
from unittest.mock import Mock
from scapy.layers.tls.all import TLS
from scapy.layers.tls.handshake import TLSClientHello, TLSServerHello, TLSCertificate
from  scapy.layers.tls.crypto import suites
from justniffer.logging import logger
from justniffer.tsl_info import parse_tls_content
from justniffer.http_info import parse_http_content
content = b'\x16\x03\x01\x02\x00\x01\x00\x01\xfc\x03\x03&\xec\xfe\x9d\x1a\xf9\xb1\x11~b\xcd\xbc\x14\xd1[\xbc\x0ca\x1eh}\x9f\xb4vwf\x02xp\x18s\xc1 \xed\x86\xb6\x9dv\x1a\xc3\x14\xc8\xad\xc6\xd8\x9d\xbe\xffb\x07\x1c\xc4>\xd2\x9f\\O\x0b\xc9!\xfe\r\xd3T\xa6\x00>\x13\x02\x13\x03\x13\x01\xc0,\xc00\x00\x9f\xcc\xa9\xcc\xa8\xcc\xaa\xc0+\xc0/\x00\x9e\xc0$\xc0(\x00k\xc0#\xc0\'\x00g\xc0\n\xc0\x14\x009\xc0\t\xc0\x13\x003\x00\x9d\x00\x9c\x00=\x00<\x005\x00/\x00\xff\x01\x00\x01u\x00\x00\x00\x13\x00\x11\x00\x00\x0educkduckgo.com\x00\x0b\x00\x04\x03\x00\x01\x02\x00\n\x00\x16\x00\x14\x00\x1d\x00\x17\x00\x1e\x00\x19\x00\x18\x01\x00\x01\x01\x01\x02\x01\x03\x01\x043t\x00\x00\x00\x10\x00\x0e\x00\x0c\x02h2\x08http/1.1\x00\x16\x00\x00\x00\x17\x00\x00\x001\x00\x00\x00\r\x00*\x00(\x04\x03\x05\x03\x06\x03\x08\x07\x08\x08\x08\t\x08\n\x08\x0b\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x03\x03\x03\x01\x03\x02\x04\x02\x05\x02\x06\x02\x00+\x00\x05\x04\x03\x04\x03\x03\x00-\x00\x02\x01\x01\x003\x00&\x00$\x00\x1d\x00 \xa7\xd6\xc0\xc4~]\xa7\xf6\x16\xfd~\x95\xee\xec\x0f\nb$\x0f\xb3\r\xbc/N\xdag\xda4\xb3\x0eq"\x00\x15\x00\xaf\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'

context = ssl.create_default_context()
ciphers = context.get_ciphers()

chipher_names = dict([(cipher['id'], cipher['name']) for cipher in ciphers])

b'\x16\x03\x01\x02\x00\x01\x00\x01\xfc\x03\x03\x1d\xf9C\xacI\xc3\xa8@d\xaf)%!r}\xa7W\x90\xa4\x07\xdb\xbf\x7f&b[{\x1b\xb8b\x00H (]\xf7kL\x8ff\xf9ZK\x0cZH\x07\xbe\xa2T\x12/\xfawM\x0f\x8d\x1c0y\x99A\x0e\x85\x89\x00\x08\x13\x02\x13\x03\x13\x01\x00\xff\x01\x00\x01\xab\x00\x00\x00\x12\x00\x10\x00\x00\rwww.midesa.it\x00\x0b\x00\x04\x03\x00\x01\x02\x00\n\x00\x16\x00\x14\x00\x1d\x00\x17\x00\x1e\x00\x19\x00\x18\x01\x00\x01\x01\x01\x02\x01\x03\x01\x043t\x00\x00\x00\x10\x00\x0e\x00\x0c\x02h2\x08http/1.1\x00\x16\x00\x00\x00\x17\x00\x00\x001\x00\x00\x00\r\x00\x1e\x00\x1c\x04\x03\x05\x03\x06\x03\x08\x07\x08\x08\x08\t\x08\n\x08\x0b\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x00+\x00\x03\x02\x03\x04\x00-\x00\x02\x01\x01\x003\x00&\x00$\x00\x1d\x00 \x04\xa7\x94\x12dO\xecu7\xa0\xb1\x8aq\xc0\xbb[=\xbe\xe2\x05\xb4\x98@\xbd\x8d\x105\x0e\xc6\x0c\x9eO\x00\x15\x00\xf4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
_codes = dict()

for c in suites.__dict__.values():
    try:
        _codes[c.val]= c.name
    except:
        pass

def _cipher_name(c: int) -> str:
    return _codes.get(c,  f'Unknown (0x{c:04x})')# type: ignore


from cryptography import x509
from cryptography.hazmat.backends import default_backend


from cryptography import x509
from cryptography.hazmat.backends import default_backend

def extract_cert_chain_from_tls_cert_message(raw_bytes):
    if raw_bytes[0] != 0x0b:
        print("Not a TLS Certificate message")
        return []
    # Skip the handshake header (1 byte type + 3 bytes length)
    pointer = 4
    # Read total certificate list length (3 bytes) from pointer
    total_chain_length = int.from_bytes(raw_bytes[pointer:pointer+3], byteorder='big')
    pointer += 3
    chain_end = pointer + total_chain_length
    certs = []
    while pointer < chain_end:
        # Each certificate is preceded by a 3-byte length field.
        cert_length = int.from_bytes(raw_bytes[pointer:pointer+3], byteorder='big')
        pointer += 3
        cert_data = raw_bytes[pointer:pointer+cert_length]
        pointer += cert_length
        try:
            cert = x509.load_der_x509_certificate(cert_data, default_backend())
            certs.append(cert)
        except Exception as e:
            print("Error loading a certificate:", e)
    return certs


def extract_certificate(raw_bytes):
    # Locate the start of the certificate (typically after the TLS handshake header)
    cert_start = raw_bytes.find(b'\x30\x82')  # X.509 certificates typically start with ASN.1 DER encoding
    if cert_start == -1:
        print("No certificate found.")
        return

    cert_data = raw_bytes[cert_start:]  # Extract certificate data
    try:
        cert = x509.load_der_x509_certificate(cert_data, default_backend())
        print("Extracted Certificate Details:")
        print(cert.subject)
        print(cert.issuer)
        print(f"Valid from: {cert.not_valid_before} to {cert.not_valid_after}")
    except Exception as e:
        print(f"Error decoding certificate: {e}")


def test() -> None:
    logger.info(len(content))
    tls_packet = TLS(content[:])
    if tls_packet.type == 22:  # 22 = Handshake
        handshake = tls_packet.msg[0] # type: ignore
        if isinstance(handshake, TLSClientHello):
            print("\n[ClientHello]")
            print(f"  TLS Version: {handshake.version}")
            ciphers = [
                _cipher_name(c) 
                for c in handshake.ciphers or []
            ]

            print(f"  Cipher Suites: {ciphers}")
            # Extract SNI (Server Name Indication) if present
            for ext in handshake.ext: # type: ignore
                if ext.type == 0x00:  # SNI extension
                    sni = ext.servernames[0].servername.decode()
                    print(f"  SNI: {sni}")
        elif isinstance(handshake, TLSServerHello):
            print("\n[ServerHello]")
            print(f"  TLS Version: {handshake.version}")
            print(f"  Selected Cipher Suite: {_cipher_name(handshake.cipher)}") # type: ignore
        elif isinstance(handshake, TLSCertificate):
            print("\n[Certificate]")
            print(f"  Certificates: {len(handshake.certs)} presented")# type: ignore

    elif tls_packet.type == 23:  # Application Data
        print("\n[Application Data] (Encrypted)")

    elif tls_packet.type == 21:  # Alert
        print("\n[Alert]")
        print(f"  Level: {tls_packet.level}")
        print(f"  Description: {tls_packet.description}")


def test2() -> None:
    breakpoint()
    content = b'\x16\x03\x01\x02\x00\x01\x00\x01\xfc\x03\x03\x1a\x8b\xf9\xbc;\xe1\xf2[\xbe\x07\x9b"k\x9b\xb1"iU\xdb\xf9\xc5\'\xd6\xc48\xa5E\x8f\'h/\x98 j\xf0\x84\xfe\x1a;#96\x11\x1es2\x80\x86"\xeaN\r\xd4V\xf6\xb9%\x8d\xbe\xca~\x9d[:\xcf\x00\x08\x13\x02\x13\x03\x13\x01\x00\xff\x01\x00\x01\xab\x00\x00\x00\x12\x00\x10\x00\x00\rwww.midesa.it\x00\x0b\x00\x04\x03\x00\x01\x02\x00\n\x00\x16\x00\x14\x00\x1d\x00\x17\x00\x1e\x00\x19\x00\x18\x01\x00\x01\x01\x01\x02\x01\x03\x01\x043t\x00\x00\x00\x10\x00\x0e\x00\x0c\x02h2\x08http/1.1\x00\x16\x00\x00\x00\x17\x00\x00\x001\x00\x00\x00\r\x00\x1e\x00\x1c\x04\x03\x05\x03\x06\x03\x08\x07\x08\x08\x08\t\x08\n\x08\x0b\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x00+\x00\x03\x02\x03\x04\x00-\x00\x02\x01\x01\x003\x00&\x00$\x00\x1d\x00 5\x1a4\xd3\x0b%\xc2\xa6\x97c\x8b\xd8w,\xddf\xe4j\xa0\x1b\xdc\x11\x97\xa9\x11\x82\xad\xa9(\x8b\xf84\x00\x15\x00\xf4\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    t = parse_tls_content(content)
    req = TLS(content)
    logger.info(t)
    response = b'\x16\x03\x03\x00z\x02\x00\x00v\x03\x03\xdd\xfd\xe9\xafr(\x84\x95F\x05}\xcce]\x8e\x88%\xa0[\xb9\xee\x17\x81\x0c\x9f\x92#\xfd=@\xe4^ j\xf0\x84\xfe\x1a;#96\x11\x1es2\x80\x86"\xeaN\r\xd4V\xf6\xb9%\x8d\xbe\xca~\x9d[:\xcf\x13\x02\x00\x00.\x00+\x00\x02\x03\x04\x003\x00$\x00\x1d\x00 \x9f<\xe8\xf6j\xe22r\xd7\x02\x12&\xf8\xaf\xf3)\xcc\xf8\xa9\xce\xb6\x9c\xbd\x03\xacI\xff\x80^PUV\x14\x03\x03\x00\x01\x01\x17\x03\x03\x00$\xa6*\x17\x15\x03\x9fb\x82\xe7\x92#\x02\xbc\xefk\xaa\xe9\x04\x86\x17 \xe4\xa7\x9f\x92\t\xd4x\x9d\xd0\xb7\xf0}\\\x8e\xaf\x17\x03\x03\nI\x9d\xc9\x98\x93\xcd\x9e\x08-\xa6\xd2\xc8\xb2\x9b\xeb\xe0{\x8e\x97#78\x9e\xee\x86\x02\xb1\xd7"\x11\x9f\xe8w\xddr\x9b\xc5n\x98\xb5}jh\x17a1H\x8f\xffQ\xd2\xb56t\x9a\xd6\xa0\x9e\xed\x04;\x87^\x0c\xa7\xe7z\x02\x1eX\xfd\x07\xb7\x1a\x02uHa\x07\xbbv&F1\xf6\xf1\xa6\xdcc\x1f\xa1\x84\xba\xa0\x04O]\xe6\xf6D\x01\x0f2:\xc8\xe7U\xab\x0f\xf6\x12\x96k\xcf67{\r\xe0A\x04\xc3\x0b"\xd0!A\x14\x1b\x80$\xf4\xe7\x82\xa6c\'\xa4$\xf0R\xf4\xa4<\x14V\xf3\xb7\xe2\x15M\xb3\x99dNG\xae\xcb\xbcs\x1b\x042\xef\x14\x11\x83kL6\xbc[\xbf\x10\xfb\xdeh3A\xd0\xf9\n\xf2\xd8\xe0wG\xfcM\x1b\x01\'\x06\xc9]\xbf\xdcb\xdea\x06B?\xccJ\xfe" \xdd\x08\x17\x86F+\xc7\xb3\x11\x0f\xb8\xc82\xed\xe9\x0e\x12N\xc7\x0f7d\x87W\xfe\xbb\xd4\x93O\xd8\xcbz-\xf06\x02\x8f\x07#?e\xb3\xbd\xb9\xe5\xae\xae\'\xe89],\xb4\xaa\xdaJ\x19a\xa4\xd5\x17!\t\xb3k&`\xb2l\xfcS\x8a\x13h\xa7JM\x16\xc1z\x12a\xb1_\x1c\xf2R\xfa\xe1\xae$\x9eu\x89\xea\x0f \x9c\x18\xa4\r\xd4p\xb4\x95nM\xeeY\xb8\xc5T\xe8\xe5\xb5\xbc\xc8\xa8\x91 \xa9\x80\xaa\x1fxv\xf6\x08S\xa9\x02\x98\xb2m\xbf;\xee1(`\\\r\xb1\xdc4:NP\t\x94\xfd\xb9\xc2(\xec\x8eU\xd2\x0c\x80\xb6?h\xddV\x823\xff\xf4\x03\x83`\xb2\x18\xde\x99yG\x9d\x8e\xa7\xc2\x19=\x9b\xa9\xc6\xce\x16\xeb\xeb\xe4\x9aD\xacS\xee\x0f\x8b\xac\x01=BC\xd2\xe5]\x7f\xec\x0e)\x98z"Eg\xf4\xe9,\x0b&\xfb\xfd\xf6\xc3r+%b8\xe5l\xf5\xef\xd5\x106\xed\x1e\xba\xd1\xc3\xeb"\xe2\x01<uK\xd0\xa47\xf3\xbe\xfd@\x82\x9f\xbdG\xc4\xff\x9f\xb6Tx\xabI\xadq\xec\x06\x10\x9f\x18\x9fd\x16\x98\x92\x1b\x10,\xc8?\xe5\n\x06V\x8c\xe6\x80;6+\xd4j\xb4p\xc2\xcc\xa6\xed#\xd3\x89\x04\xaaW\xc5\x10a\xc2u\x92{6\x94\xb4E\xb9\x89\xcb\x01\x16\xbf\x88.q\x93\x0c\x0cb\xa5_\xd3\x8e\xa8\x12\x00\x02\x9d\xaf\xccg\xac\x98\xc0\xad4/\xb2\xdb\xed!\xe0\xe8?\xfa\x0e\xd9\xb0\x1d\xe41N\xbf\x83\x86\x81\x8cC\x10\xfe?\xf5\xa6[]@|`r-[\xdf\xc1\xac\xa6!\xc4\xd7\x8d\xcap\xb8+\xa9*.\xed\x92\xaf\x02f\xce\xd5\x0c\xb0\xae\xd2_\xd5\xef\x152\xdd\xb6\xf4\'\xca\x983\xdeH\x8cX.\xf3\xf2Q:\xb4B\xd8\\\x13\x0f2!\xea\xcd\xbcn\xa9\xa5\xb3lm\x11vM\xfa\xb5\xb1\x04\x81\xc3\xea\xe4T!\x1f\x9e\xa2\x8bc\xa9\xd6\xfd"\x8e.\xe3u\x12\xce_\xeb\x82\xcan\xc1\xbc\xa1\x95\x97\xe5\x18\xfa;\xe6\xa0\xaa#\x94\'\x00uD\xab~\xe9\xf8\xfa\xd6<\xd7\x1d\x9f|\xee\x93\xf0~)\x0b\x1f\xfb\xf1\x91\xb55\xa0\xa5`aXv*\xca$\xc3\xbaei\xb46\xcf=\xb0\x8f4rd\xf9\xc7\x1a\x96E\x80\xf6\xcc\xbd2r\xe7P\x1c:Y\xce\xb6\x16\xbf\x1a\xe1\x9f\x87\xb0p\x7f,\x10x%\'\xc4n\x14\xcd\x89\xe8\xe3\xb3\x8e\xfc}\r\xe8^\x9f\\\x82\x17\xc2\xfb\xd9\x19\x8f3\xa8\xb4C\xe1\xd8\x96dD<\x15\xf2\x85\tg]g\x1c\xf7\x8a\xbfH#\xd9\xa4);\xac\x03\x83\x9b\x98\xa6\x1c\x80\xcb\xf9\x9f\x07\x18\xe6n\xf4\xbaw\xc7\xdf\x80_\x82&\x01\x84\x98\x16;\x04p*\xf2S\xcf\x10\x007\x05\x1aM\xda;\xedH\x17\x0b\xf3\x8c\xdaA\xf5\x08\xa8\x07\xb1\x9d\x99\x13\xa0g\x10*?\x9f@\xb1\x8b\xfaE\xb6Br60-\x99 K\xf2c\xca\xd7_\x12U\xe6\xa4\x86\xee\x81\x1f\xeb\x12\x1a|0\xfd\x9a{\xe3\x94:KM\x86`\xf2\x03\xd0\x9el\xf4\xf8"\x0f\'5W\xd9\xdes"\x1c\xebzk-i\x97\xeb=\xfe\xa1\x90\xcd6l\xb3\xe1\xec\xc1\x9a`\x9fM\xb5\xad\x9b\xb4b\xad\x8b\xc0\x02:"\x9d\x11\xae\xad\xb4\xcb\\\xe5\x99\x83\xcc\xaf2`\xd2D\x92\x9e\x86\x18\xd4T\xcb\x83`\xfdB\xab\x17\x90\xb8\x12\xee\xab\xc8i\x83\xf7\xaf\x07\x8a\xb6FV\xda\xd3\xf7\xf5Z\x823\x88\x9b\xd4\x14\xd265\xb6<\xac]n\xe8-\xd2\xd1\xde\x13\x00\x8f[\x0c\x9e\x84&\xef\xb2x\xe5\xe5\x01\xad7\x91\x89\\}/(\xdb?\x80\xb5(\xd2\x8b\xfd\x11_\xf5\xd8\xc7on\x866m\xbd\x04i\x90"\x1ab\xc6:\xda\xa5\x89\xf4?\xc9\x95\xf4\xeam\x849;\xce85\xc3{ \xd2\xdf\xca7.=g\xad\xcb\xa1+\xb9\x86G\x0e\xe9\xa6\xe8-\xd4\xdaB6\x1b(F\xaa\xe6\xc7\x01o\xda\x13w+|\x1d\xaa\xb3\x82\x80#\xdd\xd1\x92\x86\xa7\xc5\xfdF\xad&7\xf0\xbcy\x08\x1b\xaeN\x1a\x0c7\x8f=\x0c0A\x92cK\x16C\xbcR\x7f\xa3\x1f\xff\xfe\xb4\xd4\xd7\xa3\xcf\xfc\xf3V\x0b}\xab\xeaT\xa6\xdd\xffg`\x08\xf4\xbf1\xa6\x0c\xd7e7\xbfhK\x9c\xcdqd\xea\xbc\x83\xe9\xe1`\x010\xe8\xa6Q\x96=\xb5\xd2J\x19\x00\xa7\xe7\xe1\xc9\x16\xf4\xda*g\xf4nav\r\x03\x9ek\x88:\xd2\xae\xae\x18\xd1\xbc\xd9\x8c\x83/.lx\xf2y\xc1\x99\xee\xe3\xfd\x98wK\\\xa3\x8c\x1d\xceZ\xcb\x93\x90J\xe9\x13\xec\x95G:;B9\xa5\x05x\x7f\x80\xedh\x05m\xcfn\xbb\x18\xae\xc2\x1d7\xda\x06\xad\xff\x80R-#\x7fG\x9c \xdf\x08^\xfa\x9c{\x12)r\xb7\xb71 J\x8b\xc9\xbfi\x93\xee\x90M@\xf9q\x86\xe12\x82\x9ao\x1c\xee\x15\x99{\x80\x0eJ+\xf7\xae\x85C\xcb\x10\xb8g\x90\\\xa0\xb4|]2[\x92D(\xf45\xc6z\xa8;\r\x99\x8d\xe8\xee\xa6/Q\xfc\x08d\xdd\xac\xfa\xc8\xfa\x83F\x010\x0e\xd6~\x8aO\xf4\xf4\xd4\xec!\x97\x8d\x0b\xaa\x8eJ8\xad\xe1\xda\x8f|S\xc9%\x9c{\xd2\x0c\x97\\8\x87\xfbe\xa0\x94\xe1\xceJ\x86\n\x93F&!\x97\xcc\xba6\xfai\x14\xf4\x8a^\x82\x93`\x08\xe7\xc5H\x8fk\xa9\x8f\x96s#I\xdd\x99\x0e\xd3\x04\xcd\x9e\xa6\xb1B\xb1\xa57\x92\xae\xcfAsg\x1d}]\xe3e\x9c+\'X\xa6\xff\x08 \x1b\x1c\x13\xd4\x15&\xe0\x17\x8f\xcb@(\xdc\xb9>\x014\x19\xc9\x88\xcaa`\x9f\xa3\x9c8IF\x9f\xe7\xe7\x99T\xf0\x006\xeb\xa93\xa4Q\xc6\xd7(OVH9\xfeL\x9eY\xd2\xae<O\xc23X`\xd6\xca\xd9\x03wT\x91\x05?)\x95\xc4\xc3\\`\x02\xf8\xc8\x0c\n\xc5Xo-R\xeb\xcb\xa9\xf0\xd41\x1f\x1d\xd8\xfa\x1a\x06\xff\x96\x15\xaf\x15\x1e\x1ew]\xd9\xec\xb9\xb4~\xa1\xcf{d\x88 I^n\xd0[/\x9bN\xac\xf4X\xd2\x0e.\x18E\x92j\xeaX\xa0l .\xc1l\xc1}j\xd6\xa0\x8c\xf7~\xbf\xab\xea;S\x85ka\x8ak\x8c\xfd\xf2\xb75j\x96\xc3\x8a\x07=6\xd3!\x1d3C\xe0\x1d~c\x8cU\x03\xbf\x06\x0bG\xf2\xf4=`\xbc>\x16Z\x93\x86tW]\x80\xc6\x08\xf9\xef\xac\x1d\xf7R\xcbr\x0b"\xbd\xde\x01b\xe0\xfc[\xd1\x99mr\x1c\xe3!\x14\xb0BP\xf2em4\x9b~\xb4%\xf5\xccsF\xe1\xf9t\x98x3\xdb\xa4\xc6\x10ab\x16\x19\xbc\x88\xc1\xef\xb2\xe28\x96\x8dK~\x1c\xd2\x11*\xed\xe2\xc3\xc9E\xab\x7fw\x80\x01\x93\x81\xee\x9aU7\t\xc7\xcdFg\xfch\xda\x83\xf7\x8f\x1c\x83\xf8\xca\xca}\xda\r\tg \x995\xd2\xd87W\x0e\r:\xbb\xe0\xa1#Nh\xe3\xab\xf2\x0c,\xb9\x97\xa3\xacS\x90\xa7{163M\xf2kC|\x93m\x99\xfe=\xed~\x1a\xb4>|\x84;\x11Y\x0f\\\x89\x8d\xde\x9d;\x96\xb7\xdf\xabX\xdbCU@Z\x94\x10\xf2v{\xf1\xad&P\x00\xce\xbe\\\xba\xc9\xec\x01\x89B6\xde\xb1\xf6\xb9\xd2-\x1c\xa2\xc0x\xe0\n\xb3\xcd\x8c\xe9\xbe\x0fZV~+\xe8\xc7C\xee\x94\xf3\x83\xbf\x9b\x80\xf1\xe6\xa5\x15\xb5\x06\xba\xcd\x007gR\x06I\xdb&\xd7\xf7\x9ce\xd9\x1d:\x0bC\xb4\xb6q\xac~\x9c\'\x07\t\x9a.\xd9\x1d:0\xd5\xbe\xcb\xa7m\x8f\x86\xe1w\xc6\x82\xcc\xc9X\xef\xb3@\x18\xda\xf3s\x83\x02\xd0\xa9\x86$\x01\xc9_s\xf1\x92\xaf&\x05-\xf6y\xa0S\xcd\x9e.\xa6\x8f3\xbd0\xceE\x08$GZ\x80\x056\x16\x8aH@\x9b^\x15T\x93p9\x84~\xde\xba\xd0\xc1\xde\x9ch\xbc\x1a\xccgZ\x83\x82\xder\xc7\xeb[\xd6P\'\x1b\xf8\xdf\xc3*\xf5G\xf0\xf6\xdd\xca\xbbC\xbf?\xd6,\x9aH \n\xd7\xd64,B\xfa\xe2\xbf\xcf\xf2\x8c9X\xf1j\x0cb}\x1bg\x83\x91+L{KF\xef\xcb\x0fe+\x0b\xbeA\xe7\x99\x01\'\x8cK/\x0b\x1c\x0e\x11n&\xf0h\xfb\xd0\xe7\x1a\xc5\xe1\'\x9f\x9do\n\x01\xac\xdaN\xf25O\xf2\xc4\x80\x95\xea\\\xc3+X\xe2\xad\xf6\xc7\xc9\x04e\xe9\xab*\xc3[Bh\x12\xa1)\xc5\xe9\x06\xbd\xbalO\xbd\x04\x95\xa2\x91\x92\xb9IA.\xb6\xc7G\xedASf\xea\x92\xdac\xf5\xe7\xd6\x96\x05u\xef\xa8!\xdc{\x13T\x86\xa1\xebd\x88^-\x02 \xa2\x92[s\xfc\xe8\xd6\xa2s\xe2\xc4\'h\xdd^\x94\x8d\x1c.\x1f\x80\xf6\x92.\xd2n#pC,\xfa\x9f\x977cG\xbc;\x9dt\xd7L\xbe\xba[\xd2/T\xa1i\xa6\x16N\xdb6\xb4\xf1C\x9c\xed\x93\xfa\x1e\xc2s\xdd\xd0\xe9\x8e\xecJ2Vv\xf5\xf1\xd5n\xd6\x02\xaf\xf3\x8f\x0b\xb3\xd4\xa4\xc9\x9e\x97\xcc(T]\xb5HC\xd2\x19\x91\xde\x05W\xed\xe7\x96\x02\xe5\x07\x92\x8f\xe4M\x056I\x9d\x99a\xfc\\\x98s\x9d\xd4Kb\x95\xa1\xb1\x97\xa0\xa6\x03|\xc0\xa4\xdbo\xc8\x9f\x1dRd\xab\xd2\xc2a\xf9c4\xc7\xbe\xaf\xfd\xc0 \x91\x1bdH\xd9L\xb9<\xe0\xa0\xe7\xf7z\xf1V\x07|\x8b\t4&\xa0\xb8lN\xe4\xecC\x96\xce\x14\x9bU\xf9\xc0\x82\xc1\xeb\x8a|\xdd\x15\x963W\x89\xb0\xc3*{\xac\xdag[:y\xbe\x82\x16y\xe5H\x0f~\xb8\xb7\xa5\x03\xeb\x85eC\x1e\x9a0\xb3\xe6BPb\x08\xbb\x13\xff\x00\x05\x1b\xe1\xd2\x11$:'
    res = TLS(response)
    t = parse_tls_content(response)
    logger.info(t)

def test3() -> None:
    content = b'\x16\x03\x03\x00z\x02\x00\x00v\x03\x03A\xec\t\x937kU\xa5\x0fJ\xd7n\xa7y\xbd\x1ec\xeb\xe4\xc8\xfa=d\n\xde\x91*ms>\xdb\x95 O+\xf0_\xf8\xa9\xec\xee\xa92\xcd\xe8\xbd\x0c\xa4\xe2\x856\x85h\xe3\xef\x12\xc5\xec\xa0\x10hMkj \x13\x02\x00\x00.\x00+\x00\x02\x03\x04\x003\x00$\x00\x1d\x00 \xc8\xb9\x7f\xa8OW\xc0\xfct\x03\xac}\xf9\xe3x\x7f\x0e\xe5_\xbe\xd7]P\x1a.\x0cr7Q\x01\x07\x1c\x14\x03\x03\x00\x01\x01\x17\x03\x03\x00$az\xb1\xc4g\xbc\xb2\x05\xa5\t,\xee\x1bxUI\x0e\x17\x92U|\xd7\xdb4\x99\x06\xb7B\xe5\xa2\xa0\x0f\xba\x05\xb26\x17\x03\x03\nI\xb4\xd6\x97\xeb\xb7w\xe5\xfd\xfaLz?L;\x83\xf3C\x05\x1f\x0bk\x856K/\xe6Q\xeev+<\xfb\xbdi\x9d\xdc..\x13\x99$\xe7\xbe\xd7\xb0\x0f\x8d\x95\xf4\x1fH\xd5\x83\xc5\x9e{\xda\x1f\x8d\x1c\x9f\x07p*\xa0\xb9\'>\xe4{k\xdd\xe4\xa5<\xbe\xf6\xd6\xfaC/>HX4\x82\x98\x01\xf1\x07=\xfd\x02E\xd4-MX\x163Op,H\xa340\x80\xc5il1&\x94\xabf\x14\xa3\x9fH\xb1\xcc\xf0:^1\x05c\xa0p\xf8O\xc4+\x9ba\x0f.\x84\xbf\xcf\xee\x15D\n\xe8\x19\xd9\xc8\x84\xaak~e\x19Iu&6\x17\xbc\xa3H\xda\xa8\xe3\xe7\xe7\xacy\xf4\x832\xfag\x17\x9e\x08K}} \xef\xc2\xe5Y\xe4\x0b\x96\x83u\xfd\xef_\x053\x87\x88=\xd3\xda\xa3\xcb\x0e1\xcb\xd5\x08\xa4\x03\xd3p\xa0AV\xf3\xd7n\xc5\xc5\xe9\xb5\xc3\xc6B\xaap\xe1\xceK\xe6n;eg\xcc\xc4\x85\xf4\x03\xdd6\xa7\xa6,\xba\xa5\xbf\xdb\x8a\xa4c\x8b\x84l\xbd\xeb/\xe0\xec~Dw\x0f\xb9\xbf@G2j6^\xcde\x98c\xda\x9b\xc1\x04\'\xae\xd0 ({X\x9b_2>8{\x1b\x16\x90(\xba!\xff\x02A\xae\xb2\x97\x10\xdf\xd1)n\xfd86\x94\xc6\xb4+\xbaB\x1b\xa0\x91\x7f\x16\xa3\xf8o\xb9\xf4{\xc1T\x1e\xbfn\x1d\xa0\x07\x04\x9f\x89\x8fJ\x11i\\\xd5;\xbc~eS\xa35lBC\xc5\x00Y\xaa\xa6\x9e\x90hT^\xfb\xbf(pxzw^^\x98\xe4m\xa7\x95\x9f\xac\x0bh\xa0\xaf\xd8\xd9\xd5\x91V\xe9\x00\xfb\xbb\xb7\x10\x81\x8d\xa9\xf4\x9f)\\\x14L4\xfb\x84\xae\x0c\x12\xca\xc3\x08\xcc*\xf5\x88\x1ez\xf3v\x99\xcc\xbf\x1a\r]#\xf7`\x1b\xe6\x10*p\n;h\xff\x85\xdfS\xc8t\xb5\xbe+\n\xd0^u\x9c\x90\x05\x16\x7fb+\x9a\xd3j\x1d\xc6\xfa\x0c36\xf4\xdd-5j<\xb3\xbd\xbcG\xd7\x9b\x85~]\xa8(\xf3\x01v\xd2\x02\x97\x0b\x9f\x14n\xee\xe7\x16d\xf7q>\x93\x9d~\xd5\xa2\xe5\x0f\xcdS\xc8`\x9e\xa7\x05\r\xc4\x9f\xe6\xfd\xad\x96\x93^\xd9\x8e\x81*{{\xe4\xd8A\x18\xfbF\x8f\x81\x13\xe7u\xbb\xf2\xcd\\\xfdTP:\x1b\xb8\xff\xec\xf2\xfe_]\xcfe_$L\t\xd5q\xa5hXp\xa1~Y\xd1\xf5)\xb9\nNrw\xf6\x00K-r\x15\x8f\xf4\xd4#\xe8Z\xba\x1a\xf0[G\x82\x14u\xdd\x90,\x7f\xd1=\xf7\x88\xa6\xb0\xb3\xe9P\xb8\xc0\xff\x8e3\xb2\xfdr\xa4\xd6\xa8\x00\x0ef\x00\x0f9\xca\x107\xcf\x8c\x0f/m@\x0c\x83\xe8z026B\x1e\xfeY\xb5B\x08\x95\xa9\x11\x00k\xe7y\xceoO3\x15\x06\xf8\x08\x08n\x1a\x0f\xbeC\xeb\xa7\xec\r\xd1\x10|\xe5\xc2 #\x12\x18d\x1a3J\xe8I\x10Fi\\\xc3\x81\xe9\x85e\xb4\xaf\x82\xd8?0\xe7\x1c\x1c1v\t}\x8c\xccd\xcc\xc5\x82E\xb9\xc0\xad\x0f\x03\x12.\xbd\\\x83\xf8\x8d\xf3b\x0b\r\x80}\xaa\xdc\x95\xff\xbby\xfb&&\xe3\xf3\x9c2\x15\xc6\r\xc8\x06Stb\x08xUH\xdd\xce\x1b\xdb\x8c\xceP_\x9c\x12\xc4\x97n\xdc\x17\xe0P\xb6\xc3\xca\x95\x07\xaf+wg\x19!V\xb7\xab3\x07\xc4\x93\xa2(\x9c\xd0m\xb22\x8d\x99\xeb\x13\xe6~\xc4\xd6\xa2\x06*\xd6o\x07\xd2+lym\x85\xbc\x10\\\xaa-\x1d\x99\rn}\xc8\xc2\x07\xcb\xc0\xd8\x07\x84\xd82\nd\xd5\x03\xb2Vt\xd3\x12\xec\x93\x8c/\xcb\x16F\xfc\xd9\x9c\x14;\xdc\x8f!\xf6\x17~\x14\x95\xc8\x12\x9e\xa7E&\x82\xb2\x15\xbb\x12v\xb5:\x99\xf41\xc6<\x94\xe8\xd5\xc6?7\xe0\xd9\xdf\x85\x1bl}\x8c\xf3\xacO\xcd\xc0\xf6\xf2\xfe\xa2\x94\x18$\x1f\xab\xbc.Gn\x0f\x03\xba\xf7\x81kO\xa1\x7fb\xcf\x07\xc3%\x8b]\x99\xfc\x98\xb5o8y\xce\x95\xc0\xdb\x10T,\x81\xda\xb6\xa1\t\xbd\xa9E1\r\xc0d\x8b \xa9|\x06V\x0c\xc9~\xe9\xd2\xf2_\xb0\x19G\xff\n.\x9e\xf8O\x83\x8d\xad\x03\x9ed\xfa\x14\xc6\xe7\xed\x0e\xaa\xd8:\xdb\xe2M\x9b>JG\x90N\x0e\xdb\xdf\x01\x9f\xa4\xd4\xfd\xa9\xd9_\r\x1c]\x8d\x88d]\x9b\x8c\x07/\x890\xa5\xb48\x13X\xa7\x10ZkR\xc22\xc3\x19/\xa7v\x9d\xdf\xab\xcd\xb5x\x80\xba\x041[}r,\x97\xbe\x1d\x06\x83d\xc0_c\xfa\x0fJ"\xda\x04P\xc2\xa5\xd8`\xb7\\\x06`\x99\xeb\xca*Yh\x80\x9d\x94\x05\x80)J\rY\xaf\xc6\xbaH\x03\x16\xca\x038I\xeb\x96\xa9\x97-\x83\x91\xc0Q\x82\xec4\xd0gK;\xdb\xafZ?\xc6\x14\x89=\xf6AO\xf6\x1e*\xe5s\x01=p\xda~\nF\xf5_\xf3\x90OTF\xd2$\x0b*\xa0\xf8f\x13&1\x9e \xacri\xdc\xa3\x04\xe7\xda]\x8b\xb1v\xb8k\xbc\x1a=2\x15)\xddc\xd7\xb5O\x16\xd2\xe7t$\xa8\x96\x04`\xf9X\x90\xc3i\xa1\xaacil\xf4\xc5I\x8b&~`Ql\n\xa7 \x812@c\xbb\xc9s\xe8e\x9a\x03\xc5\x14\x7f\xf8\x1fZP\xc2\xe4\xd1\xdbm\xc1\x18\xad\xab\x8f\xa9\x7fY\xa7\xa0\xe88(5\xaf\xf8\t\x9d\x10\x1a\x13A\x9dHm\xc1\xa4,\xe0\xfb\x8e\x94u\x0e\x0e(F\xc2\t\xc2\xf3\x89\xdb!\xcf\xb8x\xfedr\xb3\x0e\x9c\xda\xe3\xbf\xade[K\x87\xd5\x05\x02u\x9aR`\x0c\x08\x07\xc1\rj9nb\xd0{\xa2K\x93^J\xca\xcdQ\x9cC\x00`\xf2\xb6\xc1;)\xc9oWUJ\xd9\xa1\x18N,\xf6\xf6%Tc\x94\xdc\x8f\x01\xf5\xbfFWD\xc2A\x94\x1a}\x99o\xc9\xceG\xeb\x9f\xebY\xb6O\xca\x80\xb8\x97\xa5Q\xa8j\x8c\x86\xb2/\n\xe1\x92$\xbbK\x98Q\x9e,V3\x1bn\x0fc\x94\xa2\xa0\\\xfcq\x07\xbf\x84\x95\xbd\xd8*\x0b\xd2`2\x85\x0b\xf0\xf2\x07\xf6"\x9a\xf5FJf\xed\xfa7\xea\xaco\xcf\xc0\x8a\xe7\xb4\xe0\x80m.\xd8e%K\xb0\xf0:9\xfc\xf3z\xbb\xcc\xdf~\x0fQ\xf4,\x16\x90\xe3{\x8e\x95\x04.lr\xfa\x95\x06\xddA\xa1\xe0~+\t\xe6V\x0c\xf6\xd9\xfe\xe5#\x1d\x86\xdbYEYlR\x17?y\xffiT@_\xca\x10\x7f+:!2\xee\xc6\t\xc8\x869o>\x00%5J]\xef\xadP\xa5\xcf\x9f,\xe5\x98\x9c\xb6/\xbe\x84i\xc5\xb4\x96\xc9\xd1\xcaU\x0c\xd6tc\x83\xa3 s\x93Pte\xac\xea\x17P\x0cF\x0f\x954\xa2\xa7%~\xc1\xc6|\xa2H@"\xf6\xfaT\x99\xba\xd8Zq7@c\xe1\xb4\x11pO\x00c\nx\x02=gT\xd3\x88xOo\xdb\x9d\x05\x14\x98\xf4\x95d b\xa1\xd5lg\xa4!\x8c\x05\n\xfc\x84\xf7\x9d\x065\x85\xf7\xd1sl\x9bj\xba\x02T\xd2\x8d\x94)\xc64\xcb@\xacJq6#\xb1=\xa8xh\xc6\x9bA\xe5}\xf0\xb7\xadC\xe5\xcc\xd8\x06\xeb\xcc\xd6\x0e\x86\xfa"\xab\xf9\x93\x86\x16v\x8e\xbe\xa4\x8ez5!\xbdW\xb0\xac\x7f\x05%f\x10\xf3pU]\x0c\x9b\xa6\x851\xa4\xab\x0e\'RT\t\npn\xe3&\'n*1\x18\xad-l\xacr\xa7\x1e\x1e\xb1V\x97Tm\xbf\xb3\x8d-(6F\xe0\x19\x16W\x9d\xa4c\xad\x88\xec$\xf5S\xd3\xdb6\x8d\xd1%9"d\x8a\xe5|\xbe\xde2Nv6rQ\x93~\x00\xf2e\x9c\x12\xd7Cr<9\xff\xce\x01\xd1\xc0E{4A\x12\xd3\xcf\xb4\xfa\xead\xe3\xff{2\xack\x0f\xab\xf2\x0cx\x11\xda`b:Nz.d\xbeKH\xff\xce\xdczl\x93%\xe3\xac\x04?\x1f_\xa1\xfd5\x9aJ$\xc1\x82+2%\x9a\xe5\xab\x9c1Jw\x01U\xeaC\x1fDt\x12>\x19\xac\xab\x83\x91\x9f2\x8a\x98\xd2Wu\xff\x06\x81\x95zOQ\x83jhr\xa2awi!7\xbe\x19\x03R\xa7n\xdfz\x8f\x18/\xb7\x8b\xd9\x85W\xdd\x15\xbb\x158\xe2\xe3\xe4\x8b\xfaz\xae\xe6\x9a\xbbA|:\xcb\xdd\xac\x13\x0b.\xf1\xff1\x92o\xb8Qw.\x19/\x00]#ON\xbe\x07x\x0eY\xed\x9bd\x05\xbci\x84\xf6\x17\xa5\xb1\x9c\x04\xf2\xbb\\4\xcd\xb4\xf3\x04\x03\x85\x19\xfa\xf9\xc1\xa8\x9e\x82}\xf5x"\xc7[\x9e}Y\xddg\x11\xf2\xc2\x05V\xf3\r\xf14\x1b\xaa\x12,\x7f\xc2\x12\xa9\xc9f\xfe\xd9\x18\xf9\x00\xc3\x16\xed\xe0eI-\xcaa@\xd0n\xa6\xba\xfa\n\x8d\xd5S&\xb4fO\xe9\xd2\x02W\xf1\xc6\'\xf1\x9d\x03\xa3\xacl\xb4\xea\xfbv\\^O\xaaYu\xfc\xbf2`M2J\xeb\xeff\xe2\x1a\x8e\xec\xa7\xeb\xb9`E\x9d\xa1\xdc\xbaQ**C\x14L]\xc6PtE\xf9\x99\xf7\xb6\x97\x1e\xbb?d\xb8\xaa\xcb\xef\xcec\x9d!\xc6\xe8\x11\x16\xd1l\xd4\x17\x8c\x97\x00ws\xe3\xcfphU\xfd~u\xb2\xc6)\x80\x8b\x12\xf9\xcbP\xa4_\xdd\xb8/\xff\rY\xb6\x13\xe9[\xf5\x91\x84\x94n\x8c^O\xee{\x83\xe2\xf9w"\xff,c;\x0e\xd7\xe5\x90\xcf\x9f\x9e\xc3d\xe2q\xb9\xcc\x8e\x90x\xb5\x07\xfcN\xd3j\xf5\x9e\x8b6\xd8\x93\xad0om@\x06\x19w\x0f,Pn\xe4\x00[6\xfc\xd1\xd5\x14M\x82O\x9a\x82\xc5\xady\xc9\x15!Fg\xa0/\xa9\xff\xf4\x8d%\xd5\xcb\xd7\x81V=\x89&\xb0d.\x1c&\xc2\xcf\xa5(\xfa\x9c\xf6\x8f\xb0\xccQ\xf7Q\x14\n}M&.\xe39G^\xf4\xbc\x97\x94\xb6\x84\xbd\xed\x88\tJ\xdf\xbc\xc2\xbe\xd7\xc6\x0e\x12\xe0\x16*\xeb\xd5e;Y\x15E)\xc6=\x0b\x86\xaaQ\xbf\xdf\xca\x91nSgq:\x8d\t66"\x17%\xe4\x1f\xdfN\xa1\xfd\xa3l\xd2\xf3\xa00\xda\xfc+\xe4\xe3jh\n\xcfKP\xd6\xde\x96\xea\x11\x94\xf2\xea\x17\x868\x92_\xc2\xb1O9\xf5\x88\'\xfbt\xf3\x02\x08\xed\x9aE\xdc\xcbw\x8ac\ta \x8a\x9f)&\r\xb7V\x0fm\x136\x05\xa1K?\x8b\xb8\xd6\x15F\xfd\xefgNkNL\x01P\xb5\xc7\xacQ@~\x8f\x19\x16.\x04ux\xd88aa\xc0\xf0R]\x9a\x89\x9f~\x06\x17\x0c\x051\xd1\xcbD%\xd9I\xa8\xfb\xc7\xf0\xd7E3\xca\xcb\xfc\xe2\xf4\x04=NaK\xecu\xde\x1c^G\tf\x18'
    t = parse_tls_content(content)
    logger.info(t)

def test4() -> None:
    content = b'\xd2\xed\xc2\xf9\xa0\xb3\xeb\x89\xa9=\xca\xab\xec/\x96{\xc8\x03-\xbe\xb6\x97g\x98\nK\xee\xc7\x8feUPf\xbfL\xc8\x8a\xc0@{\xbaz/\xd2\x147\x88\xff\x8b\xb6~\xc8\x91\xb7\xe93\xa6\x15\xbd\x14\x7f\xfd\xcc\x00\x9fob\x84\xf6h\xcd\xcdZ\xf2\xbb\xf2a\x82j9\x98\xd5\x11oN\xed\x08\xe9\xe8\xc5\x01\xee\xaaN1\xe9\xc6e\xe5\x0b\xa8\xaf\xf7X\x1b\xb6EB\x13\xb3\x19)\xaa\xe0\xb7\xe9\r\xaf~dgD \xf7\x89\x84\x0c8W\x195\xf82\x10\x86\x0e\xd0\xf0=\x87b\xbdVL\x18\x1c\xec@\xbd-\x1efp)\xe4:V\x83@2\xdd\x8d\x93 \xa6"@E\x11\x8fyQ\xf1-~\xa2w\x98\x9cW\n"\x00&\xd81+s%n\xd1\x98\x9f\x18&\xb5\x1a\\{<\xdc\xaer+(0.\x1b6\xb6V\xb1\xe88Ot\xa05\n\x10\x19%\xa3_\x1e\r\xa8\xfb\xbb/\xfd\xdd\xa9\xe9\x84\xd2\x87_4zP\xa4\xefc\x03\xc6(\x95) /(\x85\x05\xaeTx\xcd\xa3Vsr\x8a\xbdq\x05\xe4y\xe6x\xb8<VML\xde4+\xbe \xe0\xcd\xc9#4\x97\xc4w\x10\xa9\xf3\xe6\xd8\x8a\xd2\xb6\x89\xf62I\xac4\xf0\xc9\x19\x9fa;#\xb4\x16\x91L\xb5g\xefo\xcb\x97\xc0y\xd0y\xe4k\xe7\xca$ax\xa52e\xb3\xed\x9e\xf0\xb3K\xe5\x84\xf1\x08\xdd\x8a\xf1\x7f\xe4\xdf\xce\x0bFnu\xe5\xda\x82~\xdar\xe1\x12\x043/!\x82\x95,\x12\xa4omE\x1e)=\x85\xba\xc3\x8d\xf1\xb2\xf4\xf1\x0c\x8d\xba\xe9\x87\xafeH_EW\xf3D]\x92-e\x89o\xcd\xd1\x99\xb8\x94\xe9D\xb9\xc5\x9c\x00c\x81\x0fS\xbeG\xe77\x82}\xe1\xfbmS:\xa6\x98\xee\x0b\x8b\x80y\xe5\'\x8f\x88Xb\x99U\x1f*E\xb5n\xa6\xf5\x1b\x89d\x1f\xa01\xcbU;\xaf\x16\xe3\t\xd9 >Qw\xa4H\xd7\xb2\xa3:7s\xf4qt\xc4\xe2\x8a\xe0\xfbxk;\xe0\x1f\xf1\xc5\xab\xf4l\xb9}\x87\x08\x8f\xf5$NJ\xfb\xebG\xb8\x934\xd8`\x849\xf7\xd8\xa2\xde\x87Y\xf9\x04;\x0b\x0c\x8c\xce&\xec\x95\x11\xb4\\\x00\xe7\x93\xaf\x18\t\xce\r&\x1e\xe7\xbf3\xe2\xb6,\x7f\x1a\xac\xc5\xedu\x9b\xf5B\xac\x9f\x9evd\x98d\x07G{\x99\xe6\xfb9\x83U\xe9\xe8\xc8\x0by\xdce\\/\xac\xd86\x94\xd5;\x11\x00\x8b\xecH>[\x18\x81;\xeaZ\xd6\x826\xee.\xf4\x00\xc1\xf6\x15\x17X\xd9\x13\xd2)9\xe4SY6K\xa7\xec\xce\x14\xed\x08\x0c\xbc\xcb[\xa3|\xac\x921\xdf\xa4\x9cn\x85d\xf0\xbf^\x08\xfc\xd3\xcf\xa5x\xe5\xa8\xceF\x8fW\xa2\x8c\xb0\x02\xf7\xa9\x90\xd3\x94\xfeN!T_\xf43ZC3)d \x15V\xc9\xb5\xf6(\x199\xac/\'\x04\xf8\x9a\xb1p[\x0f\xe8\xccj\xe8n{\xec\x05\xbcfd\x1d\x84\xd7\xd88\x1a\x0b\xcf\x85\x9c\x18z%\xaf\xadv%\xcc\xfe\x93\x91<\rhN\xb2c\x8dU\x1ex\x17\x02OUP\x83\xaa i\xd4a\xe9Q\xa1\xa8Nf\x8b\xff\x91\xfe`6c>\x1c\xd7\xc3l$\xa0\xed\xe6\xa60E9\xc8\xa3;\xceM\xce\xc3\x8a$\x99h\xa8\xd6{\xa4\x8d\xd1\x8f\x07e\x04h\xe7.7f\xf1\x05SDn\xd1U\xf3\xf2?(H\xa0b9\x84\x96}h@\xcba>n\xdc\xbe=\xc0*\xf5X\xbf\x94rZm[\xf4\x9c\xeb\xa3&W\xeb\xebrSJ\x19Q\x1bE|k\xdb\xb4\x15\x95\xeeM\xc4\x9b\xb4\xe7\x0c\xdd\xc4\x8e\x1au\x1d\xc9!P\x8b\xe9k"\xf4\xb0\x81-\x96\xf4\x0bB\x93\x92J\xa5\xc2\xd4t\xd0\x13L\x89\x8b~\xf4!A\xef\xd5\x17\xca\x03\x16`\xe7\x08\xb7\x07U\x120\xe0;\x8dY<M\x99\'A\xd1m\xa1\x17\xb4{\x9at_\x8b|\x90\xc7\x9b\xa9e\xcb\xd6\xca\xc8A\x8a\x94\x9e=e\xb3C\x90\x03Kh\xe3\xd4\xf6g\x1bM<]\xe4w;\x9ec\xf1\x89g\x1d&"\xfee\xb4\x96\n&\xde\xc7\xfbz\xf2\x01Jz\xb8\x99\xa2\x94.\x03\xb4"\xd9K/\x8a\xa0d\xb3\xe8X\xfa\x8ciH\x19\xa8\x02K\xe4\x91L\xf0\xbch\x93-\xd5\xcb.\xb3\x9f\xb5,Q$\xe9\xb1J4\xf6m\xa8\x06\x06\xcc\r\x05\xa6/\x08\xc2g\xc0\x90r\x9es|\xfc\xb3E\xa8\x17&\xf9\xf7" T\xe7\xd3\xd1c\xd6m[\xb4\x1e\xf1TO\rP\xf9\xd4R\xc4\xbd\xaf\xc6\x04@_\xfa\x85\xe0*3)\xae\xe0\xf8\x02\x03\xed\x8d\x8c\nS\x11\x0e\t\xcek,\xba\x7fy\x88?"\xabqz_B\xdd\xfb\xfc\xff\t\xd9\x1b\x87=\xb4 #K\xe3\xf1e\x14!\xf1\x1b\xe9T\x80%\xa8%\xfc;\xfe\xb2\xcc\xcb\x04\xe4\x03\xd1\xe7\xe5\xb4\x8c\xf1\xa3\t\xb8\xf9\x82\xb5\t\x15\xf13\xa5\xbf\xec\xbdN5\xf5g\xe0\x87*C\xea\xcf\xc5\xe7\x84n\xf4\xe4\xd2LR\x82{\xf2\xf3\xcbM\xe8\xd4\xc4\x99\x08\x1bM&\x97\xdf\x87\xf8[n}\x7f\xbb\x13q! \xb9\xd7Q/RR\n\xe4\x19K\xacb\xf9d\xe4p\xd9c\x14(\xc3\x90%Ut\xca>\xdd\x0f\xdd\xfc\xf4\x17\x15i\xf6\xc6\x92TZ/\xfa\x1d\xb2\xa9\xb3&\x08[<\xc9CB\xa3F\x97\xa4\xee|\xbd\xd9^\x00+\xec%ML\x16\x8a\x10\xe5\xcccY\xf5\x01]\x15|2`*\xf5\xa04\xc6P\xf2\x85\x14p\xee\xd6\x94\xc9\x83K\xd4\x18a}\xa9\x14\x0f\xf6$5\x0f\xaa\xdc\x87\xb0;\xd1WTe\xa6'
    t = parse_tls_content(content)
    logger.info(t)

def test5() ->None:
    content = b'\x17\x03\x03\x00\x1a\xd1\xa5\xb7\xf1\xefA\xe6a\xd5\x13\xe9\x8f\x80\x7f\x95\xb6rn\xa6\x1f\xb7\x05DS\xc5\x00'
    t = parse_tls_content(content)
    logger.info(t)

def test_fatto_req() -> None:
    content = b"\x16\x03\x01\x02\x00\x01\x00\x01\xfc\x03\x03U\xe9[\xdc\x9d\xcc\xfbn\xa1\x0e{\xd5\xf4v\xe1\xd6\xae\xa5\x87d\x9d5l\xe3\xb3\x82\x82\x12\xf8\xbc\xe4y \xe7\x9f\xf4\x02\x11\x94\x12\xc2\xd3\x99r2\xbb\xec_a7\xde\xa9\x0f\x17\x9d\xd0\xd2\xbbr0\xdf\xe1V\xa2\x00\x00>\x13\x02\x13\x03\x13\x01\xc0,\xc00\x00\x9f\xcc\xa9\xcc\xa8\xcc\xaa\xc0+\xc0/\x00\x9e\xc0$\xc0(\x00k\xc0#\xc0'\x00g\xc0\n\xc0\x14\x009\xc0\t\xc0\x13\x003\x00\x9d\x00\x9c\x00=\x00<\x005\x00/\x00\xff\x01\x00\x01u\x00\x00\x00\x1d\x00\x1b\x00\x00\x18www.ilfattoquotidiano.it\x00\x0b\x00\x04\x03\x00\x01\x02\x00\n\x00\x16\x00\x14\x00\x1d\x00\x17\x00\x1e\x00\x19\x00\x18\x01\x00\x01\x01\x01\x02\x01\x03\x01\x043t\x00\x00\x00\x10\x00\x0e\x00\x0c\x02h2\x08http/1.1\x00\x16\x00\x00\x00\x17\x00\x00\x001\x00\x00\x00\r\x00*\x00(\x04\x03\x05\x03\x06\x03\x08\x07\x08\x08\x08\t\x08\n\x08\x0b\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x03\x03\x03\x01\x03\x02\x04\x02\x05\x02\x06\x02\x00+\x00\x05\x04\x03\x04\x03\x03\x00-\x00\x02\x01\x01\x003\x00&\x00$\x00\x1d\x00 \x14\x95\xed\x03\xc2[*{L\x80\xe5\x19\r?\x07\xf3\x16\x00\x91BA\x11\xb18\x93\x82\xc5\xf1\xf1\xdb\xffl\x00\x15\x00\xa5\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
    t = parse_tls_content(content)
    logger.info(t)

def test_fatto_res() -> None:
    content = b'\x16\x03\x03\x00z\x02\x00\x00v\x03\x03\x9c\xbe-\x1aJ\x0eJ\xa3\xe4\xd3\xd3\r\xa4\xdf\xb1\xda\xef\xba\x01`T\xac\xe6\x88A\xbc\xc0\x1a\xd1\x02+: \xe7\x9f\xf4\x02\x11\x94\x12\xc2\xd3\x99r2\xbb\xec_a7\xde\xa9\x0f\x17\x9d\xd0\xd2\xbbr0\xdf\xe1V\xa2\x00\x13\x02\x00\x00.\x003\x00$\x00\x1d\x00 Lo\x15\x16\x92\x9b\x84\x01\x16Fq\x04b*\xac}\xa0r\x10m\x9e\xbeJ\x15\xf6e\x1cc\x10\xce$1\x00+\x00\x02\x03\x04\x14\x03\x03\x00\x01\x01\x17\x03\x03\x08\xe8\xc8\xb95%&\x16\xf8|\x1e\x98\xfc\xab\x00\xc5dB8\xf3\xcb9\x8a\xbc\xfb\xf6u\xcf\xf0G\xdaN\xd4\xbft,1[\xc8c\xe3-?\x82Gn\xce\x88GbI\xf9\xd3s\x80\xa3\xcbF\x12\xb9\xff6 \xe9\xf7\xd1/\xde!\xeb\x11\x0f\xf5"\x0f(3\xdaU\x05wmpbqku\x074\x0b\xc2\xdc\x19\x8ci\x18W\xcd\x8b\xb4 \xb9T1\x0c\x07]q\xa7\xb8;\x80cU\x1c\x85\x87Im\x08\xa3\xa9\xc6\x82\xd2g\x18x\x8bug~\x86\xfd\x17\xefG\xcc\x9a\x19\xa2\xd3i]\xf0%,\xc9\xf8-\x1f\xd1uq\x92-0\x1al\x9f\xb1\xec\xccaB\xfdb}\r\x1aU\xd8\xb1|\x88\xfe.\x95t\xd7\xde\xc4S\\\xc6\x7f\xac\xab\xca\xe7\x83\xdd\x11\xe8?Y\xbcW\xe4\xd5\x96\xa8u\xc1\xf58\x8coR\xd3\xe0\x18\x18\xaa\x994SJ@\xfb\x93\x18\x80\x16\xec;\x15\xd5|\x9cqZN9c\xd1G\x04\xb6\x17\xd7kL\x8f\xcf-\xd1\xadT\xb11%\xb2\x0c\x0f]\xab[\x06\xc8O\x15\x93\x10\x8e\x01\xde_eY\x18\x03\x19\xdbY\xc8\x1d\xb5\xec\xd4:\x95]\x81_C\xf7\x1b\x92\xc8oT\xa9\x0f3\xb1N\x8b\x10\x18\xb8i\xb4v|\xe8\x1e\xda\xe3S\x13\xc1\x18\x11\xd7\x17\xf7\xf3\xaejm|\x0f\x9c+o7\xa9\xb4Z \x9a\x07\x8a2b\xdf\xf3\xbc\xd2\x19\x89%J` \xe4&up\xbbDF.\xddV5\xb8#\x13Uq\x83\xa1!_b\xe5\xb5\xaa\xccC?\x06\xb1\x1a\xce\xf2O\x04\xfc\x86\xcc]\xb15\x12\x14=M\x94\xe4m\xfb\xe6\xdb;j\x04[\xc6\x10ms\xb8\xda\xecw\x80cu~\xcfv;\xfb\xfffc\xc3\x1e\xda\xac\x85\x0e\x0eu\xa8\x8d6^b\xaa*\x1c8Cm\xa0\xec\xf2\xdaGVR\xd5+\xab~\xe7\xab\xc0\xc8\xe5q\xe6\xca"\xd1\xceU\x88s\xbe\x83\xcf\x1a\x1ea\xfd\xc0\xf8\xa6\xef\xbe(#\xb8x\xdfd\xcd\x81\xfe\xf5|\xe4\x1e>\x05\xc6\xca \x12\xb1\x9e@\x99\xf3!q6\x83-\xacw ,_1\xff\x00\x00\r\xe7d\xd5\x15e\xb7yg\xec\xb2\x1688iC!#/\x96\x82\xc44\xf7\xa7\x1e*BR\xe3\xdeEPb\xe8\x84v\x0b\x1dT7F\xaa\x10\x16)\xf2\xcdn\r\x85\x85\x1eJ\xc57\xffr\xf3\x07\xea9\x87)\xcb?CH\xdb\xbc \xe9z\xb8\xd3\xf1\xa1p\x99\x0c\xac\x16M\x82x\xd3j_\xfd,\xeb\x7fO\x84R\xfdt\xfe\xe7:\xa3l\n\xb8\xf8v\x1c\xaf\xed\x97\x03\x04u\xa3\x8cKR\xcf[\x0c9X\xc1d\xbb\xf7N\xbb\xbbP{(\xea\xde@\xe1?\xd8\xaf\xc43g\xd0>V\x8c2\xfb\xc0;b\xb7\xac\x0fUt\xeag\xd3\xc8\x14[K\x9cD\xc8\x85)H\x7f\xf3}\xc8\xe08\xad_\xe3_\x89\x86\x9f\xcf\xfcQ\x82F\xbf\xe5Gb\xfa\x14M\xbf\xacd\xd3#r\xa9#\xbb\xaf\x18\xf6\xdf\xee\x7fEN\xe4\xa4:\xcc\xce~\xfc\xf1\x1cb\xccd\xf7\x15\x8f\xc9^\xc9\x92]\xa4\xfe=\xc4\xbf\x8b\x8f?%!\xc0\xa6\xc3\xec\x88\x11\x94y\xf0\x99{\x0ee\x12\xf6|\xb7\'\'\xe0\xefz\xa0\xf6\xd5\x1d\xeb\xbf\xe0\x94\xa1Z\xc1\xc2\\\x9cq\xa3,\x0f\x1an$\x03D#L+/\xb6\xbc\x07G\xd6q\xa9We\x84\xe9G\x84v\xcc\x9f\x15YFUJ\x95\x03\x80i\x18\xc2N\xb5\xcf\x95\x1f)5\x1e\x8d\xa9\x06\x12`\xf0\x00\xb9\xedG\xec\xed\xb9\x0cV\x8a\x90\xecsC\xe6&a\xcfj\xadeQI\xa29\x96\xd8Q\x1fG\xc0\xec\xff\x9d\x9av\xd0\xfc\xf5P~\x85\x16Kt\xd5A2_\xfd"\x8d\xb1\x97\x08]*\x94\xfc\x13~\xd1}\xcd\x96\x84\xb1V\xcd\xdb,\xf2\r#v\x13\xde\xa2\xe9\xb9 \x08\x02\xc2@\x15\xfa\xf6\xd3\x17]\xa2\xd1\x8e?n\xc0\xf8 \x9a\xb5+\xbeP1{\xb0\xb3\x9d\xf9iPz\xe9.Gq(\x8c2\xea\xc9t\xd2Z\x16\xb4\xc7\x05\x9d\x19\x17/}\xc8\x99\x18p\xe0\xa7(\xfd!sr\xf3k37\xeb\x81\xcaQK\x99\x00\xdb\xf4\xe1*W\x7f/\x17\xf9\xee\xfb\xcd\xed)r\x92 \x8f\xca\x9c\x8fk\\wJ\x8be\xf9\xca\x98\xb4XJ\xb5\xfc\xe6\xd3\xb0\xac\x93\x1b=\x16\x03\xad\xe0!ZM(\x9du\xd9f\xf2\xa0\xda\x17\xf1/\xddul\x15\xb8\xa6\x83\x0f\xa8d\x83\x8f4g\xe1\xe3)#\xf3\x93\x9cms]\xd9Wx\xcbV\xef\x19o\xf5\x0f\xee\x7f \xf8\xa2Hl5\xe2\xf4+p\xd1\xee\t\xe6\xce\xe9M7\x8dDy\x9b\xd2\x88a\xd3\xefl\x99\xcb\x80\xe9\xe5\xdc_\xa0\xe7\t\xb8\x88g\xc5\xd9\x1a\x10\x00\x99\xc1,\xad\xa9\xa2XD\xcfl$b\xcf/O\\\x90\xb5\x8f\xe8Zt\x1a[np\xa5\xc8F\xa3\x80\xf3\xb6l\xefX\x16A4O;\xce\x81\xa0\xa8\xc7\x0e\xea\xa3\xb1\x98+,\xb0hA> q\x88\x9b\xb5i\xc0\xd2>\xa3W\xbf\''
    tls = TLS(content)
    breakpoint()
    t = parse_tls_content(content)
    logger.info(t)

def test_unknown() -> None:
    content = b'\x16\x03\x01\x07I\x01\x00\x07E\x03\x03x\xd8g\xd8z\xd2r\x12%\x85\xec\xc1\xeeG\xa0\xc6\xe1]J\x8ec& \\\xbd\xd5\xc5\xc0:Pno \xc3\x1dM\x94\x9aw\x83\x98\xa5\xab\x8clO\x11\x02Ia\x8e\xfa\x98k\xaaZ\x9e\xb7\x92\xf6\xfa\xbeC\x1ac\x00 JJ\x13\x01\x13\x02\x13\x03\xc0+\xc0/\xc0,\xc00\xcc\xa9\xcc\xa8\xc0\x13\xc0\x14\x00\x9c\x00\x9d\x00/\x005\x01\x00\x06\xdc::\x00\x00\x00-\x00\x02\x01\x01\x00\x17\x00\x00\x00\n\x00\x0c\x00\n\x8a\x8a\x11\xec\x00\x1d\x00\x17\x00\x18\x00\x0b\x00\x02\x01\x00\x00\x05\x00\x05\x01\x00\x00\x00\x00\x003\x04\xef\x04\xed\x8a\x8a\x00\x01\x00\x11\xec\x04\xc05\x95n\xb9 \x8c\xa8\x85\x0c\xffb\x9a\xda\x89\x9d\x0e\x90\xca\x81\x1a.VB\'\x1e\xaa}\xd6\x95MO7\xc5NU\x07\xf2p\xcd\xc3\x88\x04qA\x14\xae\xb3I\xe07t\xe3\x16\x89\xbf\xd2!\xbd\x01\x7f\xe4\xf6c\x98PX!R=\x07s\n\xf6t.\x93\'\xa9%\x1bK\xf3,y\xec\xb9\x91\xf5hr\x95RA+\x99\xb8{ZMI\x02F\xb7\x08K\x16i(\x91\x01X\x01\xf3gWz\x81\xd5R\xb8\x95\xd4\x8c\x7f\x98J5\x8b\xad\xc5\x88T\x9f\x9b\x1f\xf7\xe0\'\x8c\xc7d\xd8\xe5\x82\x138\x87@\x98f\x9a|\xca\xab\xaa\xafyL#\x15\xf5\xc3<`\xa7\xb2s\xa7<W\xad\x8b\xdc\xb2-\xd20C\xc9x\x89L\x83\xd0[Fs8\x1fe\xd5\xa3\x97\xda \x92\x15\x8b\x86\xa6,##\xba \x97\x04}5ex\xb2\xa4\xda\xc1\xbb\xec\xc5\x1f\xdff\x91\x95;\x01s\xf6~\xbf\xd3\xcd\xe5\x17\x141[\xc1S\x90!\xea\xf93.tWogr<\xc3\xc8\xf9\x8a\xa8\x82\xc4T\\\x04\x14\xfd\xb1\x06\x05\xf8-b\xdb\xcd\xe0\x12\x04\x1ftdOUu\xb3\xfb\x1f\x13#F\xa5\xba\x93s\xeb\x87\xf0Hy\xdd\xfa\x99]W\xbeV\xb3\x81\x18\xb6\xcer\xcb\\D\x12\xa2\xa5\xb9(\x05<\x9d\xb5i\x8diu\'\xbfV\x94\xdes \x01 U\xe4\xac\x8b\x10\xb1_Av\xc1\x10\xb89\xb5s\xbb\xb8\'\xa2\xae\x18\xcf\xe6\x17\xa6X\xb3\x9dY\xb7\x02\x11\xbb\xba\x10\n\x94\x80\xc3Pe\x88\x82Vx\xa5C\xec x`\xab\xa7pwu\xd8:\t\xa1\x84\xdc\x87\x9d\xd3d_\x82\x9b4w\x0c\xc6X\x08\x19\xd1\x19\xa0e\xf3O?$\x0b\xae\x9cd\xdc\x1a\x9b\x05\x06`\xadV\n\xddz\x9a\xc9\xeb\x80Yy(8\x1cu(t\x1e\x8f\xf6\x14\x067\xcbw5l\xfeQ.N\x94\x8el\x15\xa3\xc7"\xb0\x9dS\x19\xec\xe2 \x02\xd5\xb3\x9e\xe0^a\x99\xae\xab"\x9dD\xf3\xcc\xf1\xfa\x1a\x9b\x84!\x03HwmG\x15{\x11\x1e\x16\xdb\x0b\xd6\xba\xa6\xbd*:x0s\x89[\xc5\x063NS\x14\x10u\xba\x1ad\xd9\xcbk\xe4-)\x91\xb5\xee\xd3\xae\xd8\x13\x04\x14\xdc\xa8\x1c\xe6x\x02\xa0e\xc2kST"7\x81\xf0|\x92\t\xa3\x1b\xf2\x9f{\xaa\x03\xe7\xc8\x96:\xaaQvS\x90\x91fr\x95\xf5g:\xe1\x93,\xf4\x1f!\x1a\xbe\\\xd5\xc2\x9c\xe3d\x82\x18tK\xb6\x89\x06\xe8\x9a(\x17r\x17\t]\xd7\x80\xa3@em!\x19\xaf{\xb6\x95\x95\xccN\xa9D)\t%\x07=\xb5R\x91\x072\x9e#ce\xbc\xb1\xc13\xb9\x94\xfb^J\xcc\x0f\x03igf\x00 \xa0\x11\x07u\xf3\xb0|B\x7f@\xb3zQ\n\xc5\xc9\xd41\xb4\x10y~,[\x0eX\x1f\x19X\xc0\xcb\x98[k\x19\xc7;)\xac\x01\xca\x968\x11#\xd6l@\x1bG\xc4J\x11f\x1d;\x8ai\x19\x05^\xa2\xc2\xa8\xe6\x18E\xa1\x9f\xf3\xc6H\x0exN\x16\xb3\x92\xf2A\xad\xea\x9a> \xec\x1a\x05$Aw\xb6\x00\x91\x81\xa6\x9c%g\x1a\x11Y4\xfa\xcd\xa7vW\xbe\x12&\xce\x00\x81\xf8\x93\x19\x8f\x10\xa1\x8a\x0c\x8e\xd6\xdb\x1d?\xa2\x0bz\xcc\xa9\x17B\xcf.\x8b\'%\xe7\x83\x1c\xea\xcc\x84\x81\x96t\x92a\xd2\x06#\x92\xd4\x1d\xe3\x19e\xa1\x80\xad\xaa\xe0\x02\x00u*\xcf"\xaa\x03\xecu\xd4\xd7!\x9d\x05H\x88`-\x1bx\x05.g#\xbf\x86\xa4\x9a5\xbe\xe1,\x1e\xc8\xb2\xc7\x8c1Iy\xc4S\x90\xd9\x9b\xff\xdc\x80\xc3\xa7j\xb09@\x96\t6+\xe6\xc17\xf8Y%\xf4\x8c\xcb\x10\xca\x03gL\x93\x90\'\xad\xf3\x0bH\xa1\xc2\xe0\xba\x04\x15\x87\xae\xa1\xfc\xad\x03\xa7c+w\x1d\xaai\x04f\x93.wU\xa3\xf8\xf2JK3!\x8fd\x12\xa4\xa2\xc7\xd1\xb7\xc4;8\x9e\xd7\x0c\x13\xcb\xd3\x9fCh\xabb\\\x0b \xb8\xc4\xcd\xdb\x87\xfbb>\xbe#\x80\xb7$%\xab\x14_\xd4\xd1>$\x87\x99\xd1z\x0f\xe0\x17\x97;A\x8b$Z\xb0 \xc1\x15\x87h\xb6\x1e\xb1Ug\x15\x8eM\xf9\x06os\x17\xef\xe9\xac\x95\x17)\x13\xf3 \xb4\xdb\x03\xe2\xa9\xc1\xb3DS\xee\x14\xab\x87\xc7\x9c\x9fl[\xdf\xb1\x1f%\xb5\xb6/\x17\xba\xaf\xd5\xbb(\xd7\x91\xe0\x8aT\xd8+\x80\x18\xdb\x1e\x94j{\x82\xc6pXA\x1bE\x87k\x0b\x19|\xe6\xab\xa0*KHm\x86\x91\x0fv\xca\xb0$\x16\x12\xe9\x8f\x1e\xe8E\xa3\xf3\xae\r\xf9m),!\xe9\xa1\xcc?\xcc&ntbJ\x94\x07\xb5\\\x9d\x15\x95\x7f\x02u\\\xa6I\x88CW\xa5\x01\x95\xc2s\xac\x8a&\x19\xb7\xe9\x94\x8b\x95)m\xc6\xc9p}\xe5\x0e\xf0\x9e6g4I7\xeek\xdda\x98u%0D\xa4\xff=6@\x93\n\xb5\xe3\xe4J\x96\xc8\x83\xb2\x1e\xf7\x0f\xce\xc0\xedx\xc6\xbdk\xb6G\xcf0\xf0qk\x048\x0b\x04(\x9c\x12\xb2\xe8\x15\x00\x1d\x00 b\xed\xeaM\xa22\xd1\xe0\xbdy:\x8d\xd3\xffs>k+\xc0M\xd9\xefO\xc6\x8b\xfa`\xc7\x9fs\xe0u\xfe\r\x00\xda\x00\x00\x01\x00\x01\x99\x00 \xf7\\G9*\xa7\xe9\xa6\xea\xc2k-\xe3v\xc9M\xcf\x96Rv\x8d\xfd\xff7\xf8=n\xd7j\x19\x91-\x00\xb0+\x1c)H9+*\xabn\x12\xfc\xbe\x08&K\x97&\x0e\xb5^\xfc\x0c\x04\xee\x8e\x15^\x14\xec\x8b\xfa\xf8\xfei\xdb\xa5\xce8\x05r(\xb7\x8a\x98,dy\xca\x19g\x9e\xf5\xac\xb4\xdb/gb#\x8a\xd0\xaa\xc7\'\xdc\x12\x06\x1a\xbd\xe8\xf0\xd8\xf1%O\xc9$8}\xba\x9dP\x1c\xd5\xc0U8\xac\xa0\xb9\x911\xb9h\xae\xfe\xf6D\xb5\x82\xad\xfb\xc4\xa5\x84{\xffO\xb3\x00\xc4z\xab&\x9a\xe1\xe9\xaf\xa8\xa4\x03\xd9tV\xf4\x13\xcd\x04L\xc7(r\xa9\xc4n\xcfj\xcd\x9aL\x99\xf4\xb4y!\x03\xac\x9fbf\xca\x1a\xc1\x8d\x11\x16\x8a2|$\xfdj|_\xba\x02i!3a\xfb=\x7f\xde\x1f\xa9\x00#\x00\x00\x00\x00\x00&\x00$\x00\x00!browser.events.data.microsoft.com\x00+\x00\x07\x06**\x03\x04\x03\x03D\xcd\x00\x05\x00\x03\x02h2\x00\x10\x00\x0e\x00\x0c\x02h2\x08http/1.1\x00\r\x00\x12\x00\x10\x04\x03\x08\x04\x04\x01\x05\x03\x08\x05\x05\x01\x08\x06\x06\x01\xff\x01\x00\x01\x00\x00\x12\x00\x00\x00\x1b\x00\x03\x02\x00\x02\x8a\x8a\x00\x01\x00\x00)\x00[\x00&\x00 !:\x00\x00\xf9\x0b\xbe\xba\x11q\xaa\xf2[f\x07\x96\xe424F\xd8o;\x8f\xc4\x9a\xe8\xc7\x8d\x0c\xa0\x82\xc5\xe6\xbe`\x0010KI\xc5\n\x07\xd2\':0P$W\xd1\x0fBA\x9e\xf8\xf4\xe8!\xd9u\xa39\x90\xe6\n\xb7\xe1\xfb\xbf\x04.v\x0e\x9aK\x19\n\xc2\x02\xc4`\xd6\x03{\x13'
    t = parse_tls_content(content)
    logger.info(t)

def test_tls2() -> None:
    content = b'\x16\x03\x03\x00X\x02\x00\x00T\x03\x03\xcf!\xadt\xe5\x9aa\x11\xbe\x1d\x8c\x02\x1ee\xb8\x91\xc2\xa2\x11\x16z\xbb\x8c^\x07\x9e\t\xe2\xc8\xa83\x9c \xf4\xd1\xcc\x12\xf0\xe6\n&/\x13lo\xc4E\xbb\x91M\xe9\xee\xfb\xe4d\xcb\xb9[@\xa3=*\xc4\xaf\xe2\x13\x02\x00\x00\x0c\x00+\x00\x02\x03\x04\x003\x00\x02\x00\x17\x14\x03\x03\x00\x01\x01'
    t = parse_tls_content(content)
    tls = TLS(content)
    logger.info(t)


def test_tls22() -> None:
    content =    b'\x16\x03\x03\x00X\x02\x00\x00T\x03\x03\xcf!\xadt\xe5\x9aa\x11\xbe\x1d\x8c\x02\x1ee\xb8\x91\xc2\xa2\x11\x16z\xbb\x8c^\x07\x9e\t\xe2\xc8\xa83\x9c .\xff\xe7\x99\xf3\xbf\xae\xcc\xcc\xfa\xca\xd1\xfb%\x9e\x19%S\xc8\xd8}\xcc\x0e\x1fR\x14\xf2\xf1\x8b\x8ex\x90\x13\x02\x00\x00\x0c\x00+\x00\x02\x03\x04\x003\x00\x02\x00\x17\x14\x03\x03\x00\x01\x01'
    t = parse_tls_content(content)
    tls = TLS(content)
    logger.info(t)


def test_response() -> None:
    content = b'\x16\x03\x03\x00j\x02\x00\x00f\x03\x03\xe0\xb9DT\x8e\xda\xfa\xb2\x88:\xe6W\x04\xfe\xc2\xd8\xa0\xa8\xd8\xb4\xd4o\xbdwgL\xff\x9cX\x8e\xe7\xda g\x94\xdfoS\xfe\x93\xdb:7P\r=\xf0M\x88i2\xcd\xd4\x1b\xf0\xfb\xf3\xfc\xfe\xd1\x96\xf6\xdc\x88v\xc00\x00\x00\x1e\xff\x01\x00\x01\x00\x00\x00\x00\x00\x00\x0b\x00\x04\x03\x00\x01\x02\x00\x10\x00\x05\x00\x03\x02h2\x00\x17\x00\x00\x16\x03\x03\n\xa5\x0b\x00\n\xa1\x00\n\x9e\x00\x05\x8e0\x82\x05\x8a0\x82\x04r\xa0\x03\x02\x01\x02\x02\x12\x05\xe7\xa2\x85\x0e\xbe\xe9x\x10m\xd3\xe6\x028\xc7\x1b\x86\x1d0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00031\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x160\x14\x06\x03U\x04\n\x13\rLet\'s Encrypt1\x0c0\n\x06\x03U\x04\x03\x13\x03R110\x1e\x17\r250323170525Z\x17\r250621170524Z0\x191\x170\x15\x06\x03U\x04\x03\x13\x0eboneragroup.it0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\x9e\xbc8\xae \xf4\xcf\xc0A\xd9\x1d\xda\x1cS\xd7Q\xd6A#\xcf\xab\x97K\xfc\xd3\x11}\xc6\xa4t\xcax\xfc\xc9\xf6\xea\xfd\xaa\x13nBZ\xc7\x9b\x96\x9f\x97Q\xb5Q\xfd\xf3u\x99\xfep\xc7\xa3i\xc0\xf9D\xae!\xb9d\x13h\x82l6\xc8\xaa,\xff\xe2eHQ\xe5.\xe8\xc0A\xeb\xfe\xbby\x1fY\x83%\xab~S~*t\x98\x9e\x86=(\x92\xc94\x80]\x82\xee\x1bf>\x03\xf5\xca\x04\xf0\t\x8c\x94\x14\xccP\xc5\xc1\xe3w|\xf9S\xe5*-v\x81\x864\xf1\x90\x83.\xac\xba\xb4\xbe\xfd\x90\xa6\x134O\x9b\xd7\x97\xdd\x1b\xda\x85\x96\xff\xd0\x19\xf7\x94\xd5\xdd\xc3S\x08\xb7q\xad{\xe2\xdd\xa9}?\x11\xaaSv\xa1J\xadFQ\x8d\x1a)y\x07\xadV\xec\xe2\x9f\xfc\x17\x96}\x96\xbe\x91\xc9\xf5_\xd1>\xae6\xb2\n\xa1Yk\x80/\x9b\xd2\x97\xfe\xa6\xb3\xfc\x19\'m\x81\xcaP\xed1v&\xb9\xf1vg\x16\xeb\xb4g\xa2\xd5}\x83\xcab\xc5L\x04\xfa\xe6\xa9\x02\x03\x01\x00\x01\xa3\x82\x02\xb00\x82\x02\xac0\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x05\xa00\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x01\x06\x08+\x06\x01\x05\x05\x07\x03\x020\x0c\x06\x03U\x1d\x13\x01\x01\xff\x04\x020\x000\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14\x1e\xc0\xa4\x92\x1b\x9d\x082\x91\x1cLS\xd9\xd5\x90\x1c\x07d\xd2\x970\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14\xc5\xcfF\xa4\xea\xf4\xc3\xc0zl\x95\xc4-\xb0^\x92/&\xe3\xb90W\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04K0I0"\x06\x08+\x06\x01\x05\x05\x070\x01\x86\x16http://r11.o.lencr.org0#\x06\x08+\x06\x01\x05\x05\x070\x02\x86\x17http://r11.i.lencr.org/0\x81\x85\x06\x03U\x1d\x11\x04~0|\x82\tbonera.it\x82\x0fbonera2ruote.it\x82\x0eboneragroup.it\x82\x16service.boneragroup.it\x82\rwww.bonera.it\x82\x13www.bonera2ruote.it\x82\x12www.boneragroup.it0\x13\x06\x03U\x1d \x04\x0c0\n0\x08\x06\x06g\x81\x0c\x01\x02\x010.\x06\x03U\x1d\x1f\x04\'0%0#\xa0!\xa0\x1f\x86\x1dhttp://r11.c.lencr.org/30.crl0\x82\x01\x05\x06\n+\x06\x01\x04\x01\xd6y\x02\x04\x02\x04\x81\xf6\x04\x81\xf3\x00\xf1\x00v\x00\x13J\xdf\x1a\xb5\x98B\tx\x0co\xefLz\x91\xa4\x16\xb7#I\xceXWj\xdf\xae\xda\xa7\xc2\xab\xe0"\x00\x00\x01\x95\xc4,\xf5&\x00\x00\x04\x03\x00G0E\x02!\x00\x8c}qA\xe2I\xe8V\xd3(\x89\x11_\xff\xbbC\xaa\xa5\x8f/\x1d\x0bM\xb3\x0f\x04\xa3K=\x83\xa2\x9c\x02 88\x95\xa8\x8f\xda\xa1o\xaf\xdc\xd1\xe8\xea-\xcd\xd7\xa5\x96\x914?\x16\x8d"\xbd\x9b-j2\xd0\xa0$\x00w\x00\xcf\x11V\xee\xd5.|\xaf\xf3\x87[\xd9i.\x9b\xe9\x1aqgJ\xb0\x17\xec\xac\x01\xd2[w\xce\xcc;\x08\x00\x00\x01\x95\xc4,\xfc{\x00\x00\x04\x03\x00H0F\x02!\x00\xb1\xf3;\xbe\xad\x15W\xb4\x177\x11\xa7|\x04\xd8\xc3\x13\x04\xda\xea\x81\x1d\xd1C0\xcc2\xe1\xed\r\n\xe7\x02!\x00\x96xR\xf3XZ\x81\\\xd2e\x9e,\r\x7fL\xae\x8f\xfd\xe1\x0f\xb9W\xecOfT@\xed\x02\xea\r\xa90\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\x17\x035FD\x92\xb3?\x06\x97\xc1\xef\xdc%\xd2\xcd\x12L\x9eB\xc1\xe2\xe3\x18\xb7\x82\xd8u\xf9i+{\x8e o:\x10\x91\xd2\xf2\xf3\x05\x1b\x98\xca\x14\x853\x9b\x029\x02&\xfb!@9\x94\xe0\xae\xa6\xea\x96o]\xb8\xb1s\x83\xc3\x97y\x94\x1b\x16\x0b6J\x8e-\xcc\x12\xaa\xeb5f_F\xac"W\nv\xaa\x80y\xcf\x17|\xe4\xa1[\xff\xdd\x82\x87\x83\'N\x9b\xa3\r\x1e\xf3\x0c\x1b\xcdaa\xed\xf3\xa6\x86H U\xf0BX@\xba\xfcn\x8e\x00\\\x80\xf8\x87\x08#\xb1O\xdd\x8b\x84G-\xd7w\xa7\x17\x9e\xbd\x1a\xc3\xbb`\x19\xc3\x1e\xb1\x1b\x9c\x0fG\xb2=\xa2\xc5\xa4O\x11\xb8\xa5\xf0\xbcQu\xfau_M\xf3]\xf9\xd5\x90\xe3\xf93<\x04\xb0\xd2\x87\xe7\xc4C\xc5\x89\x11\xb08\x14A\xa0\n\xd1\xbb<\x82\xf8@\x11\x96\x90\x03\xb2t\x90\x01\x9dA\x8a\x86\xbb\x11_7Kb3=\xe8\xfeP\\\xccS\x9f\xf0:\xbd\xdckq$\xea\xa0\x1e\xd46\x8ci8\x00\x05\n0\x82\x05\x060\x82\x02\xee\xa0\x03\x02\x01\x02\x02\x11\x00\x8a}>\x13\xd6/0\xef#\x86\xbd)\x07k4\xf80\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000O1\x0b0\t\x06\x03U\x04\x06\x13\x02US1)0\'\x06\x03U\x04\n\x13 Internet Security Research Group1\x150\x13\x06\x03U\x04\x03\x13\x0cISRG Root X10\x1e\x17\r240313000000Z\x17\r270312235959Z031\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x160\x14\x06\x03U\x04\n\x13\rLet\'s Encrypt1\x0c0\n\x06\x03U\x04\x03\x13\x03R110\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xba\x87\xbc\\\x1b\x009\xcb\xca\n\xcd\xd4g\x10\xf9\x01<\xa5N\xa5a\xcb&\xcaR\xfb\x15\x01\xb7\xb9(\xf5(\x1e\xed\'\xb3$\x189g\t\x0c\x08\xec\xe0:\xb0;w\x0e\xbd\xf3\xe59TA\x0cN\xaeA\xd6\x99t\xdeQ\xdb\xef{\xffX\xbd\xa8\xb7\x13\xf6\xde1\xd5\xf2r\xc9rj\x0b\x83t\x95\x9cF\x00d\x14\x99\xf3\xb1\xd9"\xd9\xcd\xa8\x92\xaa\x1c&z?\xfe\xefX\x05{\x08\x95\x81\xdbq\x0f\x8e\xfb\xe31\t\xbb\t\xbePM_\x8f\x91v=Z\x9d\x9e\x83\xf2\xe9\xc4f\xb3\xe1\x06fCH\x18\x80e\xa07\x18\x9a\x9b\x842\x97\xb1\xb2\xbd\xc4\xf8\x15\x00\x9d\'\x88\xfb\xe2c\x17\x96l\x9b\'gK\xc4\xdb(^i\xc2y\xf0I\\\xe0$P\xe1\xc4\xbc\xa1\x05\xac{@m\x00\xb4\xc2A?\xa7X\xb8/\xc5\\\x9b\xa5\xbb\t\x9e\xf1\xfe\xeb\xb0\x859\xfd\xa8\n\xefE\xc4x\xebe*\xc2\xcf_<\xde\xe3\\M\x1b\xf7\x0b\'+\xaa\x0bBwSOyj\x1d\x87\xd9\x02\x03\x01\x00\x01\xa3\x81\xf80\x81\xf50\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x01\x860\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x02\x06\x08+\x06\x01\x05\x05\x07\x03\x010\x12\x06\x03U\x1d\x13\x01\x01\xff\x04\x080\x06\x01\x01\xff\x02\x01\x000\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14\xc5\xcfF\xa4\xea\xf4\xc3\xc0zl\x95\xc4-\xb0^\x92/&\xe3\xb90\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14y\xb4Y\xe6{\xb6\xe5\xe4\x01s\x80\x08\x88\xc8\x1aX\xf6\xe9\x9bn02\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04&0$0"\x06\x08+\x06\x01\x05\x05\x070\x02\x86\x16http://x1.i.lencr.org/0\x13\x06\x03U\x1d \x04\x0c0\n0\x08\x06\x06g\x81\x0c\x01\x02\x010\'\x06\x03U\x1d\x1f\x04 0\x1e0\x1c\xa0\x1a\xa0\x18\x86\x16http://x1.c.lencr.org/0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x02\x01\x00N\xe2\x89]\n\x03\x1c\x908\xd0\xf5\x1f\xf9q\\\xf8\xc3\x8f\xb27\x88zo\xb0%\x1f\xed\xbe\xb7\xd8\x86\x06\x8e\xe9\t\x84\xcdr\xbf\x81\xf3\xfc\xca\xcfSH\xed\xbd\xf6iB\xd4\xa5\x11>5\xc8\x13\xb2\x92\x1d\x05_\xea.\xd4\xd8\xf8I\xc3\xad\xf5\x99\x96\x9c\xef&\xd8\xe1\xb4$\x0bH M\xfc\xd3T\xb4\xa9\xc6!\xc8\xe16\x1b\xffwd)\x17\xb9\xf0K\xef]\xea\xcdy\xd0\xbf\x90\xbf\xbe#\xb2\x90\xdaJ\xa9H1t\xa9D\x0b\xe1\xe2\xf6-\x83q\xa4u{\xd2\x94\xc1\x05\x19F\x1c\xb9\x8f\xf3\xc4tH%*\r\xe5\xf5\xdbC\xe2\xdb\x93\x9b\xb9\x19\xb4\x1f/\xdfj\x0e\x8f1\xd3c\x0f\xbb)\xdc\xddf,?\xb0\x1bgQ\xf8A<\xe4M\xb9\xac\xb8\xa4\x9cfc\xf5\xab\x85#\x1d\xccS\xb6\xabq\xae\xdc\xc5\x01q\xda6\xee\n\x18*2\xfd\t1|\x8f\xf6s\xe7\x9c\x9c\xb5J\x15jw\x82Z\xcf\xda\x8dE\xfe\x1f*d\x050>s\xc2\xc6\x0c\xb9\xd6;cJ\xabF\x03\xfe\x99\xc0F@\'`c\xdfP:\x07G\xd8\x15J\x9f\xeaG\x1f\x99Z\x08b\x0c\xb6l3\x08M\xd78\xedH-.\x05h\xae\x80]\xefL\xdc\xd8 A_h\xf1\xbbZ\xcd\xe3\x0e\xb0\x0c1\x87\x9bC\xdeIC\xe1\xc8\x04?\xd1<\x1b\x87E0i\xa8\xa9r\x0ey\x12\x1c1\xd8>#W\xdd\xa7O\xa0\xf0\x1c\x81\xd1w\x1fo\xd6\xd2\xb9\xa8\xb3\x03\x16\x819K\x9fU\xae\xd2j\xe4\xb3\xbf\xea\xa5\xd5\x9fK\xa3\xc9\xd6;r\xf3J\xf6T\xab\x0c\xfc8\xf7`\x80\xdfn5\xcau\xa1T\xe4/\xbcn\x17\xc9\x1a\xa57\xb5\xa2\x9a\xba\xec\xf4\xc0uFOw\xa8\xe8YV\x91f-n\xde)\x81\xd6\xa6\x97\x05^dE\xbe,\xce\xeadBD\xb0\xc3O\xad\xf0\xb4\xdc\x03\xca\x99\x9b\t\x82\x95\x82\rc\x8af\xf9\x19r\xf8\xd5\xb9\x89\x10\xe2\x89\x98\t5\xf9\xa2\x1c\xbe\x92s#t\xe9\x9d\x1f\xd7;J\x9a\x84X\x10\xc2\xf3\xa7\xe25\xec~;E\xce0FRk\xc0\xc0\x16\x03\x03\x01,\x0c\x00\x01(\x03\x00\x1d -#1#\x91&\xba\xfb$\xf3v\xaf\xdf\x89\n\xc3\xbf\xac\xda@w;%\xab\x9f \xd1\xa3\x1f\x91\xa9Z\x08\x04\x01\x00YN\x01\xaf4\x07\xac\xc3&\x98\xe5+\xd8F\x05\xf2&\x8d\xcf&\xa5\xf7\n\x85\xa2\xc3i!\x84\xf7\xee\x1bT=\xaa*\xec\x00q\xa7\xa2q\xfcTw\x8e\xed\xcb\xcc\xa5[hXD\xd7\x9c\x8f]\x8c9\xbb\xec\xd8$\x18\x9buM\xa0\xce\x8e^a\xc1\x9b\t\xa8\x03\x95\xac\x93c\xd0TQ\xb9f\x8a\xa4\x1d\x97K=E3\x8ckS\xa9\xa3/X\x00\xf2\xbe\xb9\xc0\xddv1\x89\xbf\x8b\x08;\xbf\x8e\x00\xe09\xb1\xb9\xa4\xdb\xf1\xfa\x92\x10\x84\xd7\x08ba\x93\xa9gdx\xaa6\xf7N\xf5\x97C\\j\x17%\xcfT17\x86m\xdf\xabE\x17j\x0c\x81\xbd\x95.\xca\xc3\xd3i3H\x04-\xb3\x12_K\x83nz;w\xfac \xb8\x15\xd5x5\'\xdc6Kjz\\\xe6\x90n|(\xa0v~\xca\xab\xe5(\x8f\xac\x03\x9dr\xb3\xd9i\x1f\xb3}\xb49\xa1\xb5\xa6h\x9e\xe8v\xc7\xea\'44)\xf9\xb3#\xec\x1d-\x7f\xc1@}&\xb8\x044\xb7Fv\xef??\x0e\x16\x03\x03\x00\x04\x0e\x00\x00\x00'
    tls = TLS(content)
    t = parse_tls_content(content)


def test_problem_msg() -> None:

    content = b'\x16\x03\x03\x0c\xad\x02\x00\x00U\x03\x03h\x11\xfa\x97T\x8cJ\xc2b4\xfc\xb0\x93\xe6Lh!\x19^\xcc\x89\xe2\xa6Ix)\x9b>\xc8>J\x07 \xfc"\x00\x00o[\xd4\x84\xfb\x9a\xce\xe4Ex\xc2\xc5\x00\xcb\x13\xfeI\xe7c\xf8\x83\xea\xd3\xfb\x9fO\xd0\xf2\xc00\x00\x00\r\x00\x17\x00\x00\xff\x01\x00\x01\x00\x00\x00\x00\x00\x0b\x00\x0b \x00\x0b\x1d\x00\x06\x860\x82\x06\x820\x82\x05j\xa0\x03\x02\x01\x02\x02\x10\x06\xcc6\x1a\xe2>\x81\xaf+\xe8Q+\x8a]p~0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000`1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x150\x13\x06\x03U\x04\n\x13\x0cDigiCert Inc1\x190\x17\x06\x03U\x04\x0b\x13\x10www.digicert.com1\x1f0\x1d\x06\x03U\x04\x03\x13\x16GeoTrust TLS RSA CA G10\x1e\x17\r240530000000Z\x17\r250619235959Z0p1\x0b0\t\x06\x03U\x04\x06\x13\x02IT1\x120\x10\x06\x03U\x04\x08\x13\tLombardia1\x1c0\x1a\x06\x03U\x04\x07\x13\x13Garbagnate Milanese1\x160\x14\x06\x03U\x04\n\x13\rSB Italia srl1\x170\x15\x06\x03U\x04\x03\x0c\x0e*.sbitalia.com0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\x9f\xdf\xc4\nV3\x16\xcf\x1a\xf1\xc3\'\x11}U\x989\xa0\xa1\xc8\x98s-V\xd0\x89\xa0\xc6\x82\x11\x0b+\xb7D\xce\xbd\x8dI\xa7s\x9b\xf6\xfa\x95\xb14\xaf\xce\xbc\xcb0\xcb{\xd5\\\x8dTq6o9y\x8c7H>/\x81\xe1\xea\xf6\x94\xeb\x11\x19r\x9d\x97\xac\xae!\x1b\xa0)\x9c<\xf6\x94f\xb6\xfd)\x10\xe1R\xa9\xad\x0e\xc8\xc5\x02>\x855O\xcaS\xbb\xddx\x04\xb3_v\x8d=\xcaV\xc1\xf2hc\xabh\xeb\xa3P}TT\x88jW\x13\n\x1b\xec`\xec\x7f\x82\x890\xde\x04\xfar\x05\x1c|#?J\x86\xc6\xcd\xd0]d\x87\xcehj\x84\x94/Wf<\x1aE\xfdVC>1\x9dlcX\xc8\x99&\xcdy\x8a\xc6\x0b%%\xb0\x1c\xe4[*\xdb\xd9\x02ch$\xfb\xe9\x8d\x05\t\xaf\xc7\xf1\xbc\xf2\x07Ru\x16\xef\x86\x03\x02\x08\xb9\xcf\x82\xdd\xa5\x01\xd4h\xc4C"\xcb\xcc\xb6\xb2Y3\x1dM\xd9\xec\x0f\xa4\xe9_\xff\xb8s~\xcd\xf4\x9f\x0c\xc7\'\xa7\x02\x03\x01\x00\x01\xa3\x82\x03&0\x82\x03"0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14\x94O\xd4]\x8b\xe4\xa4\xe2\xa6\x80\xfe\xfd\xd8\xf9\x00\xef\xa3\xbe\x02W0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14s\xaeZ\x82\xab\xa9h\xb1i\x85g\x85\xae\xdd\x13\x83\xaa\x04\x8b\xe80\'\x06\x03U\x1d\x11\x04 0\x1e\x82\x0e*.sbitalia.com\x82\x0csbitalia.com0>\x06\x03U\x1d \x0470503\x06\x06g\x81\x0c\x01\x02\x020)0\'\x06\x08+\x06\x01\x05\x05\x07\x02\x01\x16\x1bhttp://www.digicert.com/CPS0\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x05\xa00\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x01\x06\x08+\x06\x01\x05\x05\x07\x03\x020?\x06\x03U\x1d\x1f\x0480604\xa02\xa00\x86.http://cdp.geotrust.com/GeoTrustTLSRSACAG1.crl0v\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04j0h0&\x06\x08+\x06\x01\x05\x05\x070\x01\x86\x1ahttp://status.geotrust.com0>\x06\x08+\x06\x01\x05\x05\x070\x02\x862http://cacerts.geotrust.com/GeoTrustTLSRSACAG1.crt0\x0c\x06\x03U\x1d\x13\x01\x01\xff\x04\x020\x000\x82\x01\x7f\x06\n+\x06\x01\x04\x01\xd6y\x02\x04\x02\x04\x82\x01o\x04\x82\x01k\x01i\x00v\x00Nu\xa3\'\\\x9a\x10\xc38[l\xd4\xdf?R\xeb\x1d\xf0\xe0\x8e\x1b\x8di\xc0\xb1\xfad\xb1b\x9a9\xdf\x00\x00\x01\x8f\xc8\x81Z\xb6\x00\x00\x04\x03\x00G0E\x02!\x00\x81\xff^g\x8fjE\\-\xd2b\xa8\xe8\x9e\r\xd6\xec\r\xd6\x08\x01\xe0o\xfe\xd6/\xf0^u\xe23\xc6\x02 1q\xd6\x87\xfa|\x97\xc7E\xbd\xcem\xf0\xab\x80\x9d\x7f8\xebR\x83Q+\x03W\xe3\x11jr\xc0\xaf\x8c\x00w\x00}Y\x1e\x12\xe1x*{\x1cag|^\xfd\xf8\xd0\x87\\\x14\xa0N\x95\x9e\xb9\x03/\xd9\x0e\x8c.y\xb8\x00\x00\x01\x8f\xc8\x81Zj\x00\x00\x04\x03\x00H0F\x02!\x00\xf1\x91sX\xa5c\xf0\xfdo\r\xb9Ex\xccu\xcd^q5\x04\xfc\x85\xce\xd9\x1e~\xb3T!(\x91\x8a\x02!\x00\xc3\xf5f\xaa#\xdc\xa1.\xe3j\xbb\xf1\x08\x87%\x13\x00wy\xdcG\x0eNs\x06d\xb7x\xf6cM$\x00v\x00\xe6\xd21c@w\x8c\xc1\x10A\x06\xd7q\xb9\xce\xc1\xd2@\xf6\x96\x84\x86\xfb\xba\x872\x1d\xfd\x1e7\x8eP\x00\x00\x01\x8f\xc8\x81Z\x7f\x00\x00\x04\x03\x00G0E\x02 )\x88\xfc\x82\xc9(\x89\x18\xa4a*\x19\xddd\xb7_\x95\xda\x7f\x83\x16\xd9\x07\xdd\xf8T\x83\xd7~,NF\x02!\x00\xeb\x83\x1d\xba\xffB\xe1B\xd5?\x17\x1d\x1a(\x99&;.\x88\xa9\x93\x10\xb0*\x8b\xc12d5tM!0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00H\thF\xd7\xc2\xb3\x1dE\x1c9\xf4\x12\xde\xc8\xda9\x1c&t\xdcb%\xa5)\xefRP\xbd\x9a?\xda\xa0U9\xc5M\x16\xfa\x10\x93\xd6\x90\xbb\x14!\xdb\xaa=\x96n,X\xa7\x03l\xacx{\xf8\xab\xa7\x8c\r\xc1\xda`~\x90UZ\x08]\xc4Rs\xa2\xb5\r\xca\xae\x84_:\x15\x93\x9f\xfd\x07\x1f\xa6[(A.\xf2\xf5\xe5R\x01@\xc6U>\xc0\xed\xc3f#\xc5\xa0\xd2\xd7[\xe7\xe8\x80\x14\x08%\xe3S\xcf\xc5\xe6\xa6\xd5\xbf\x03O\xba\x85\xa5\xef}KI\xd8\x198Y\xea\xd3\xc5!\xbb[\xa8\xe9\xb9\xd7K5]\xb5\xfb\x17ctV4\x1c\xae\x8d\xe6H\xf6\x9a\xd9\x86\x0b7\xcd\x9bf\xa6\x1b\x11nI\xf57\x96;\x94\x90p\xd61Mf\x8c9\xb1\xe1|\x95\xfd|\xd5\x1a\xac\x8b\xe4\xfa\r\x90\xc8\xe4pQ\xf8Jb\x02\xa9\xdb]\x13\x83\xcd\xff\x9c\x95\x10\xb9!\xf7\xd2\xd1\xb9\xf7\xb6\xcb\xf2\xcaT\x00v\x9e\x02\xce[\x87\xc4\x82\xf3R9]\xfe\xe4U\xa2u\x12\x00\x04\x910\x82\x04\x8d0\x82\x03u\xa0\x03\x02\x01\x02\x02\x10\r\x07x*\x13?\xc6\xf9\xa5r\x96\xe11\xff\xd1y0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000a1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x150\x13\x06\x03U\x04\n\x13\x0cDigiCert Inc1\x190\x17\x06\x03U\x04\x0b\x13\x10www.digicert.com1 0\x1e\x06\x03U\x04\x03\x13\x17DigiCert Global Root G20\x1e\x17\r171102122337Z\x17\r271102122337Z0`1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x150\x13\x06\x03U\x04\n\x13\x0cDigiCert Inc1\x190\x17\x06\x03U\x04\x0b\x13\x10www.digicert.com1\x1f0\x1d\x06\x03U\x04\x03\x13\x16GeoTrust TLS RSA CA G10\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xbe\x17\xe8\xec\xbe)\n\xcb\xfe\xb9-a1\xfd3$\x082.Y\xe8!\xd4\xd80\xben\x10\xc8\x84\xa0?\xba\x14\xe5\xde\xfdz\x8c\x92\x1b{\xce\x84-\xf0\xffx\xc42\xe8\xa9\xa0}_\x06\xda{\x9bKS\xa6\xc6\x1b\x02\x17!\xe1p;\xad\xfb\x83\xeb\x08T\x81\xa8\xde\x12\xb2\xd5\xc6\x88\x960\xf9\x02\xfc9\xd4\xbd\xb8"\xef\x80I\x99\xd0b\xb8a\xd0I\xde\xcb\xc2\xcb\x97\xa51\x06\x1b\xd7\xd8]\xc6\xd3T\xdeR\x016*\r\xf6\xde\xc5\xb61L\xcc\x15%j\x15o\xa9k\x04H\x0c\xde\x00A\xaa(\x80\x8b/4\xd3\x1b\xb56\xad;%\xd0\x88B@l6\x91me\xb2\x19\x86\xc0\xd2\x7f9FX\xfe0\x12`P\xdc\xee\xbbs\xe6W\x90Z\xf6\r\xca\xd7\x04KGjo4\x1a\x9d\x926\x1a.\xd9NT\xedG\xac\x0c\xbf\xf1\x80\xb2\xba\xffG{\xe99\xc4T\xc4\x94T\x99\x19\xf1W\x99\xaf\xe2\x14"[\xe8.\xbbc-\xba\xae\x81\xbd\x13\xdc\xe6\x17[\xe0\x90SI\x01\x02\x03\x01\x00\x01\xa3\x82\x01@0\x82\x01<0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14\x94O\xd4]\x8b\xe4\xa4\xe2\xa6\x80\xfe\xfd\xd8\xf9\x00\xef\xa3\xbe\x02W0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14N"T \x18\x95\xe6\xe3n\xe6\x0f\xfa\xfa\xb9\x12\xed\x06\x17\x8f90\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x01\x860\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x01\x06\x08+\x06\x01\x05\x05\x07\x03\x020\x12\x06\x03U\x1d\x13\x01\x01\xff\x04\x080\x06\x01\x01\xff\x02\x01\x0004\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04(0&0$\x06\x08+\x06\x01\x05\x05\x070\x01\x86\x18http://ocsp.digicert.com0B\x06\x03U\x1d\x1f\x04;0907\xa05\xa03\x861http://crl3.digicert.com/DigiCertGlobalRootG2.crl0=\x06\x03U\x1d \x0460402\x06\x04U\x1d \x000*0(\x06\x08+\x06\x01\x05\x05\x07\x02\x01\x16\x1chttps://www.digicert.com/CPS0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\x82\x1c\x04:\x82\xe9\xc5\xa9\xc8e\x12\\\x08\xe3\x01\xc60\xb0\xae"\x88a{+\x07\x86\xf7\xb8\xb5D\x9c\xf5\x93\x06aF\x8a:\xa2\xb55&\xd0X\x9e<\xc1s\x8f\xbf\xb1y\xa7\x1c\x997\x9aS\xf2/\\n \x0b}\xb0\xc7\x82\xef\xeb\xeby\x12\x05\xe7\x01A\x0bC\x027\x9b\x1b\x1f\x08M7Rs)\xb8\x9f5\xe3\xf9\xa3:Yu\x01f\x90*>\x9d\xe0b)\x1e\x87\xa8\x80>,\xc4\xcc\x08\xc3.\xbfi!\x18k\x8f\x1ekC\xcd\xee\x06\x98A\x99\xb5\x82\xf2\x17\xc1\x10\xa5\xaeX\x8c\xfb\x95\xeaM\x82\xaf\xf3w_\x11iOxQ\xa6\xdf\xf7\xba\xc5?e\xbfp|\xa3\xedZ\x9a3\x9d\x9e?\xe3\x875\xa7\xda\xf3\x15\xc6X\xadi#\xdc\x0f\xbbL\xd0I\x13A\xa6?g\xe1^\x13\xf5\x0f\xf5\xd5|\x85\xbf\x87L\x82$a"W\xd1\xa5\x9b\xfb\x869\xad\xc3\\yfl\x071K \x91\xad\xa1\xbed\x19\x00\xee\x1e\x12x\xce\x98\xf2_\xfb0\x14i<,\xfa\x97\xc6\x0c\x00\x01(\x03\x00\x1d T\x15\x03L\xeaW\xa4\xfb\xebt\x99*,\x86\xd4lbL\x10\x85\xea\xd1\xbeK\x80\r\x1e\xa5\x9dLMF\x04\x01\x01\x00\t>\xf1\x91Ij\xff\x93Yl\xb8\xf7\x9bL+8a&\x13\xba\xac\xc1\x04\xe6\xec+6\xae2\x13\xc4\xa4\xc3\xce\xb4\x81$\xc1\xd2\xaa@k0\x0bS\x06\xe0\x10\xfcK\x9c\xb8\x89t)\x00\x97@>7\x7fI\x85\xe6\xab\x8a\x8a\xf5\xf6[\xb4l\x87T\xf4L{wY_\x83d\xdd\x06T\xe0~\x11\x14L\x07\x15\x10\x0bL\xa2n\x11\x8b\xc3o\xa8\x05.\x04x\'\xfc\xc4\xa5\xd6\x06\x8d\xc8\xbcO*g\xc8\xfd\xd4\xae\x9av\xb7\x9b@e\xd4\x1a\xe2q\xf3\xd1m\xe6S\x97\xa0<\xee\xb3\xc6l\x01\x9b\xef\x85\x8d\x8a\x03\x9c\xd7mj2\xc7\xadZ\x84g\xac{%U\xb1\xf8\n\r-\xd5Y\xe3\xd1f\x087\xcfJ\xe0G\x19\xa06lr\x1f&\xc1\\\x8a,\xcb\xe5<\xe6\xfe\x06t?\x80\xba\xf38\xacpA\xb0\xf1\x141LF]\x84\xe1+*\xca\x1aM\x94\x8a\xcf\xb7\xc5\xfd\x01\xb9\x1d\x9fJp\x9c\x94\xe1?o\xbe\x04\xd4\xf0\x05.\x8aV}\xe7\xe6K\xb7\xe0\xcek\xeb\\\x0e\x00\x00\x00'
    tls = TLS(content)  
    t = parse_tls_content(content)
    logger.info(t)


def test_problem_msg2() -> None:
    content =   b'\x16\x03\x03\x0c\xad\x02\x00\x00U\x03\x03h\x12\x03\xa8\xd1\x9bt\xf4\xc9\x06D\xd5\xb0J\x95N\xbc"NN\xc7\x14\xaa\x9axR\n\x8eR$ ? \xb6F\x00\x00\x13D\xe6"\xc2y&\x19\x10\x05l\x9c6\x01\xd72\xdc\xf5\x11Q\xc2}\xe8\x0b\xe5\xa4tj\xc00\x00\x00\r\x00\x17\x00\x00\xff\x01\x00\x01\x00\x00\x00\x00\x00\x0b\x00\x0b \x00\x0b\x1d\x00\x06\x860\x82\x06\x820\x82\x05j\xa0\x03\x02\x01\x02\x02\x10\x06\xcc6\x1a\xe2>\x81\xaf+\xe8Q+\x8a]p~0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000`1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x150\x13\x06\x03U\x04\n\x13\x0cDigiCert Inc1\x190\x17\x06\x03U\x04\x0b\x13\x10www.digicert.com1\x1f0\x1d\x06\x03U\x04\x03\x13\x16GeoTrust TLS RSA CA G10\x1e\x17\r240530000000Z\x17\r250619235959Z0p1\x0b0\t\x06\x03U\x04\x06\x13\x02IT1\x120\x10\x06\x03U\x04\x08\x13\tLombardia1\x1c0\x1a\x06\x03U\x04\x07\x13\x13Garbagnate Milanese1\x160\x14\x06\x03U\x04\n\x13\rSB Italia srl1\x170\x15\x06\x03U\x04\x03\x0c\x0e*.sbitalia.com0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\x9f\xdf\xc4\nV3\x16\xcf\x1a\xf1\xc3\'\x11}U\x989\xa0\xa1\xc8\x98s-V\xd0\x89\xa0\xc6\x82\x11\x0b+\xb7D\xce\xbd\x8dI\xa7s\x9b\xf6\xfa\x95\xb14\xaf\xce\xbc\xcb0\xcb{\xd5\\\x8dTq6o9y\x8c7H>/\x81\xe1\xea\xf6\x94\xeb\x11\x19r\x9d\x97\xac\xae!\x1b\xa0)\x9c<\xf6\x94f\xb6\xfd)\x10\xe1R\xa9\xad\x0e\xc8\xc5\x02>\x855O\xcaS\xbb\xddx\x04\xb3_v\x8d=\xcaV\xc1\xf2hc\xabh\xeb\xa3P}TT\x88jW\x13\n\x1b\xec`\xec\x7f\x82\x890\xde\x04\xfar\x05\x1c|#?J\x86\xc6\xcd\xd0]d\x87\xcehj\x84\x94/Wf<\x1aE\xfdVC>1\x9dlcX\xc8\x99&\xcdy\x8a\xc6\x0b%%\xb0\x1c\xe4[*\xdb\xd9\x02ch$\xfb\xe9\x8d\x05\t\xaf\xc7\xf1\xbc\xf2\x07Ru\x16\xef\x86\x03\x02\x08\xb9\xcf\x82\xdd\xa5\x01\xd4h\xc4C"\xcb\xcc\xb6\xb2Y3\x1dM\xd9\xec\x0f\xa4\xe9_\xff\xb8s~\xcd\xf4\x9f\x0c\xc7\'\xa7\x02\x03\x01\x00\x01\xa3\x82\x03&0\x82\x03"0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14\x94O\xd4]\x8b\xe4\xa4\xe2\xa6\x80\xfe\xfd\xd8\xf9\x00\xef\xa3\xbe\x02W0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14s\xaeZ\x82\xab\xa9h\xb1i\x85g\x85\xae\xdd\x13\x83\xaa\x04\x8b\xe80\'\x06\x03U\x1d\x11\x04 0\x1e\x82\x0e*.sbitalia.com\x82\x0csbitalia.com0>\x06\x03U\x1d \x0470503\x06\x06g\x81\x0c\x01\x02\x020)0\'\x06\x08+\x06\x01\x05\x05\x07\x02\x01\x16\x1bhttp://www.digicert.com/CPS0\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x05\xa00\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x01\x06\x08+\x06\x01\x05\x05\x07\x03\x020?\x06\x03U\x1d\x1f\x0480604\xa02\xa00\x86.http://cdp.geotrust.com/GeoTrustTLSRSACAG1.crl0v\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04j0h0&\x06\x08+\x06\x01\x05\x05\x070\x01\x86\x1ahttp://status.geotrust.com0>\x06\x08+\x06\x01\x05\x05\x070\x02\x862http://cacerts.geotrust.com/GeoTrustTLSRSACAG1.crt0\x0c\x06\x03U\x1d\x13\x01\x01\xff\x04\x020\x000\x82\x01\x7f\x06\n+\x06\x01\x04\x01\xd6y\x02\x04\x02\x04\x82\x01o\x04\x82\x01k\x01i\x00v\x00Nu\xa3\'\\\x9a\x10\xc38[l\xd4\xdf?R\xeb\x1d\xf0\xe0\x8e\x1b\x8di\xc0\xb1\xfad\xb1b\x9a9\xdf\x00\x00\x01\x8f\xc8\x81Z\xb6\x00\x00\x04\x03\x00G0E\x02!\x00\x81\xff^g\x8fjE\\-\xd2b\xa8\xe8\x9e\r\xd6\xec\r\xd6\x08\x01\xe0o\xfe\xd6/\xf0^u\xe23\xc6\x02 1q\xd6\x87\xfa|\x97\xc7E\xbd\xcem\xf0\xab\x80\x9d\x7f8\xebR\x83Q+\x03W\xe3\x11jr\xc0\xaf\x8c\x00w\x00}Y\x1e\x12\xe1x*{\x1cag|^\xfd\xf8\xd0\x87\\\x14\xa0N\x95\x9e\xb9\x03/\xd9\x0e\x8c.y\xb8\x00\x00\x01\x8f\xc8\x81Zj\x00\x00\x04\x03\x00H0F\x02!\x00\xf1\x91sX\xa5c\xf0\xfdo\r\xb9Ex\xccu\xcd^q5\x04\xfc\x85\xce\xd9\x1e~\xb3T!(\x91\x8a\x02!\x00\xc3\xf5f\xaa#\xdc\xa1.\xe3j\xbb\xf1\x08\x87%\x13\x00wy\xdcG\x0eNs\x06d\xb7x\xf6cM$\x00v\x00\xe6\xd21c@w\x8c\xc1\x10A\x06\xd7q\xb9\xce\xc1\xd2@\xf6\x96\x84\x86\xfb\xba\x872\x1d\xfd\x1e7\x8eP\x00\x00\x01\x8f\xc8\x81Z\x7f\x00\x00\x04\x03\x00G0E\x02 )\x88\xfc\x82\xc9(\x89\x18\xa4a*\x19\xddd\xb7_\x95\xda\x7f\x83\x16\xd9\x07\xdd\xf8T\x83\xd7~,NF\x02!\x00\xeb\x83\x1d\xba\xffB\xe1B\xd5?\x17\x1d\x1a(\x99&;.\x88\xa9\x93\x10\xb0*\x8b\xc12d5tM!0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00H\thF\xd7\xc2\xb3\x1dE\x1c9\xf4\x12\xde\xc8\xda9\x1c&t\xdcb%\xa5)\xefRP\xbd\x9a?\xda\xa0U9\xc5M\x16\xfa\x10\x93\xd6\x90\xbb\x14!\xdb\xaa=\x96n,X\xa7\x03l\xacx{\xf8\xab\xa7\x8c\r\xc1\xda`~\x90UZ\x08]\xc4Rs\xa2\xb5\r\xca\xae\x84_:\x15\x93\x9f\xfd\x07\x1f\xa6[(A.\xf2\xf5\xe5R\x01@\xc6U>\xc0\xed\xc3f#\xc5\xa0\xd2\xd7[\xe7\xe8\x80\x14\x08%\xe3S\xcf\xc5\xe6\xa6\xd5\xbf\x03O\xba\x85\xa5\xef}KI\xd8\x198Y\xea\xd3\xc5!\xbb[\xa8\xe9\xb9\xd7K5]\xb5\xfb\x17ctV4\x1c\xae\x8d\xe6H\xf6\x9a\xd9\x86\x0b7\xcd\x9bf\xa6\x1b\x11nI\xf57\x96;\x94\x90p\xd61Mf\x8c9\xb1\xe1|\x95\xfd|\xd5\x1a\xac\x8b\xe4\xfa\r\x90\xc8\xe4pQ\xf8Jb\x02\xa9\xdb]\x13\x83\xcd\xff\x9c\x95\x10\xb9!\xf7\xd2\xd1\xb9\xf7\xb6\xcb\xf2\xcaT\x00v\x9e\x02\xce[\x87\xc4\x82\xf3R9]\xfe\xe4U\xa2u\x12\x00\x04\x910\x82\x04\x8d0\x82\x03u\xa0\x03\x02\x01\x02\x02\x10\r\x07x*\x13?\xc6\xf9\xa5r\x96\xe11\xff\xd1y0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000a1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x150\x13\x06\x03U\x04\n\x13\x0cDigiCert Inc1\x190\x17\x06\x03U\x04\x0b\x13\x10www.digicert.com1 0\x1e\x06\x03U\x04\x03\x13\x17DigiCert Global Root G20\x1e\x17\r171102122337Z\x17\r271102122337Z0`1\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x150\x13\x06\x03U\x04\n\x13\x0cDigiCert Inc1\x190\x17\x06\x03U\x04\x0b\x13\x10www.digicert.com1\x1f0\x1d\x06\x03U\x04\x03\x13\x16GeoTrust TLS RSA CA G10\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xbe\x17\xe8\xec\xbe)\n\xcb\xfe\xb9-a1\xfd3$\x082.Y\xe8!\xd4\xd80\xben\x10\xc8\x84\xa0?\xba\x14\xe5\xde\xfdz\x8c\x92\x1b{\xce\x84-\xf0\xffx\xc42\xe8\xa9\xa0}_\x06\xda{\x9bKS\xa6\xc6\x1b\x02\x17!\xe1p;\xad\xfb\x83\xeb\x08T\x81\xa8\xde\x12\xb2\xd5\xc6\x88\x960\xf9\x02\xfc9\xd4\xbd\xb8"\xef\x80I\x99\xd0b\xb8a\xd0I\xde\xcb\xc2\xcb\x97\xa51\x06\x1b\xd7\xd8]\xc6\xd3T\xdeR\x016*\r\xf6\xde\xc5\xb61L\xcc\x15%j\x15o\xa9k\x04H\x0c\xde\x00A\xaa(\x80\x8b/4\xd3\x1b\xb56\xad;%\xd0\x88B@l6\x91me\xb2\x19\x86\xc0\xd2\x7f9FX\xfe0\x12`P\xdc\xee\xbbs\xe6W\x90Z\xf6\r\xca\xd7\x04KGjo4\x1a\x9d\x926\x1a.\xd9NT\xedG\xac\x0c\xbf\xf1\x80\xb2\xba\xffG{\xe99\xc4T\xc4\x94T\x99\x19\xf1W\x99\xaf\xe2\x14"[\xe8.\xbbc-\xba\xae\x81\xbd\x13\xdc\xe6\x17[\xe0\x90SI\x01\x02\x03\x01\x00\x01\xa3\x82\x01@0\x82\x01<0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14\x94O\xd4]\x8b\xe4\xa4\xe2\xa6\x80\xfe\xfd\xd8\xf9\x00\xef\xa3\xbe\x02W0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14N"T \x18\x95\xe6\xe3n\xe6\x0f\xfa\xfa\xb9\x12\xed\x06\x17\x8f90\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x01\x860\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x01\x06\x08+\x06\x01\x05\x05\x07\x03\x020\x12\x06\x03U\x1d\x13\x01\x01\xff\x04\x080\x06\x01\x01\xff\x02\x01\x0004\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04(0&0$\x06\x08+\x06\x01\x05\x05\x070\x01\x86\x18http://ocsp.digicert.com0B\x06\x03U\x1d\x1f\x04;0907\xa05\xa03\x861http://crl3.digicert.com/DigiCertGlobalRootG2.crl0=\x06\x03U\x1d \x0460402\x06\x04U\x1d \x000*0(\x06\x08+\x06\x01\x05\x05\x07\x02\x01\x16\x1chttps://www.digicert.com/CPS0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\x82\x1c\x04:\x82\xe9\xc5\xa9\xc8e\x12\\\x08\xe3\x01\xc60\xb0\xae"\x88a{+\x07\x86\xf7\xb8\xb5D\x9c\xf5\x93\x06aF\x8a:\xa2\xb55&\xd0X\x9e<\xc1s\x8f\xbf\xb1y\xa7\x1c\x997\x9aS\xf2/\\n \x0b}\xb0\xc7\x82\xef\xeb\xeby\x12\x05\xe7\x01A\x0bC\x027\x9b\x1b\x1f\x08M7Rs)\xb8\x9f5\xe3\xf9\xa3:Yu\x01f\x90*>\x9d\xe0b)\x1e\x87\xa8\x80>,\xc4\xcc\x08\xc3.\xbfi!\x18k\x8f\x1ekC\xcd\xee\x06\x98A\x99\xb5\x82\xf2\x17\xc1\x10\xa5\xaeX\x8c\xfb\x95\xeaM\x82\xaf\xf3w_\x11iOxQ\xa6\xdf\xf7\xba\xc5?e\xbfp|\xa3\xedZ\x9a3\x9d\x9e?\xe3\x875\xa7\xda\xf3\x15\xc6X\xadi#\xdc\x0f\xbbL\xd0I\x13A\xa6?g\xe1^\x13\xf5\x0f\xf5\xd5|\x85\xbf\x87L\x82$a"W\xd1\xa5\x9b\xfb\x869\xad\xc3\\yfl\x071K \x91\xad\xa1\xbed\x19\x00\xee\x1e\x12x\xce\x98\xf2_\xfb0\x14i<,\xfa\x97\xc6\x0c\x00\x01(\x03\x00\x1d \xab\x0b\xfe\x02\xfc^\xe6L\x98)\xac\xfa\x1a\xaae\xabm\x0c_\t%\xb1?X\xd9\x1f\xe9h\xf5\xeaAk\x04\x01\x01\x00oU\xc19\xb8h\x1f\xd2\x94i\xc9\xbb\x95=B)\x03\x04\x0f\xd5N\xf5\x92\x8eB1 \x1d%\x1a\xf2.\xe8\x9f\xbd\xc2\xbe\x8a\xfc\xa7_B\x1a\xfbb;\xe3^=\xdf\xa3\xf7\xd7`\xfd!Y\x16.\x1a\x9f\x7f\x99@O\x02\x8f\xae\xb1\xa2\x81\xcdTC@\x1d\x04\xa68\xfe\x00\x99\x15\x19Nc\x84\x00\x19\xf6B\x01\x8e\xad\x95\xb1h_\x8a\xb0\x0b9\xaa\x1d\xc1\xbb\xaf\x00e\x0e\x80\x01-\xc8\x17\xd90\xe3\xb7f\xd1QMy\xb7\x15\xfe\xbb\xf1\xc2\x9b\x8a\xf0\x83=\x87/\xf3Oy\x1e\xb2c\x90\xe9\xbc\xd8)\xc8\x93=p6\xd3\xe1-\xfb\x1dy\x00\xe1\xd3\xa55%<p\xc2\x14h#\x95\x86m\xf4\x8a\xa5\xe6?\x85N\xac\xb6\xbc\xe3\x00\x80\xf4,\t2\xcd\xc0=X\xe0\xd4\xf8\xb6tPnD\x8f\x19Cq\x14\xa6gHt\x11\x80\x98\x9f\x14Z\n\xd6\xacj\xcc%\xb1\xbfV=Z\xad\xab\xbem\x1a\xa4\xc7\x8c\xa6\x80\xa6WcF\x8f[^&A}\xb6}l]\xdb\xb8t\x0e\x00\x00\x00'
    tls = TLS(content)  
    t = parse_tls_content(content)
    logger.info(t)


def test_http_get() -> None:
    req_content  = b'GET / HTTP/1.1\r\nHost: www.bonera.it\r\nUser-Agent: curl/7.81.0\r\nAccept: */*\r\n\r\n'
    res_content =  b'HTTP/1.1 204 No Content\r\nserver: nginx/1.18.0 (Ubuntu)\r\ndate: Thu, 01 May 2025 19:59:11 GMT\r\nx-cache-status: from content-cache/1\r\nx-networkmanager-status: online\r\nconnection: close\r\n\r\n'
    res = parse_http_content(req_content, res_content)
    breakpoint()
    pass
    #HttpRequestParser(content)

def test_http_post() -> None:
    req_content  = b'POST / HTTP/1.1\r\nHost: www.bonera.it\r\nUser-Agent: curl/7.81.0\r\nAccept: */*\r\nContent-Length: 2\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\n{}'
    res_content = b'HTTP/1.1 301 Moved Permanently\r\nServer: nginx/1.18.0 (Ubuntu)\r\nDate: Thu, 01 May 2025 20:19:53 GMT\r\nContent-Type: text/html\r\nContent-Length: 178\r\nConnection: keep-alive\r\nLocation: https://www.bonera.it/\r\n\r\n<html>\r\n<head><title>301 Moved Permanently</title></head>\r\n<body>\r\n<center><h1>301 Moved Permanently</h1></center>\r\n<hr><center>nginx/1.18.0 (Ubuntu)</center>\r\n</body>\r\n</html>\r\n'
    res = parse_http_content(req_content, res_content)
    breakpoint()
